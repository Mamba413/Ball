% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bd.R
\name{bd.test}
\alias{bd.test}
\title{Ball Divergence based Equality of Distributions Test}
\usage{
bd.test(x, y = NULL, R = 99, dst = FALSE, size = NULL, seed = 4)
}
\arguments{
\item{x}{a numeric vector, matirx, data.frame, \code{dist} object or list contains vector, matrix or data.frame.}

\item{y}{a numeric vector, matirx or data.frame.}

\item{R}{the number of replication, when R equals to 0, the function return
the sample version of ball divergence. Default: \code{R = 99}}

\item{dst}{if \code{dst = TRUE}, x will be considered as distance matrix. Default: \code{dst = FALSE}}

\item{size}{a vector record sample size of each group.}

\item{seed}{the random seed.}
}
\value{
bd.test returns a list with class "htest" containing the following components:
\item{\code{statistic}}{ball divergence statistic.}            
\item{\code{permuted_stat}}{permuted ball divergence statistic.} 
\item{\code{N}}{Number of observations.} 
\item{\code{p.value}}{the p-value for the test.}
\item{\code{size}}{group sizes.}
\item{\code{alternative}}{a character string describing the alternative hypothesis.}
\item{\code{method}}{a character string indicating what type of test was performed.}
\item{\code{data.name}}{description of data.}
}
\description{
Performs the nonparametric two-sample or K-sample ball divergence test for
equality of multivariate distributions
}
\details{
\code{bd.test} are ball divergence based multivariate nonparametric tests of two-sample or 
K-sample problem. If only \code{x} is given, the statistic is 
computed from the original pooled samples, stacked in 
matrix where each row is a multivariate observation, or from the distance matrix 
when \code{dst = TRUE}. The first \code{sizes[1]} rows of \code{x} are the first sample, the next 
\code{sizes[2]} rows of \code{x} are the second sample, etc.
If x is a list, its elements are taken as the samples to be compared, 
and hence have to be numeric data vectors, matrix or data.frame.

Based on sample version ball divergence (see \code{\link{bd}}), the test is implemented by 
permutation with R replicates. The function simply returns the test statistic 
when R = 0.
}
\examples{
################# Quick Start #################
x <- rnorm(50)
y <- rnorm(50, mean = 1)
# plot(density(x))
# lines(density(y), col = "red")
# ball divergence:
bd.test(x = x, y = y)

################# Quick Start #################
x <- matrix(rnorm(100), nrow = 50, ncol = 2)
y <- matrix(rnorm(100, mean = 3), nrow = 50, ncol = 2)
# Hypothesis test with Standard Ball Divergence:
bd.test(x = x, y = y)

################# Simlated Non-Hilbert data #################
data("bdvmf")
\dontrun{
library(scatterplot3d)
scatterplot3d(bdvmf[["x"]], color = bdvmf[["group"]], 
              xlab = "X1", ylab = "X2", zlab = "X3")
}
# calculate geodesic distance between sample:
Dmat <- nhdist(bdvmf[["x"]], method = "geodesic")
# hypothesis test with BD :
bd.test(x = Dmat, size = c(150, 150), R = 99, dst = TRUE)

################# Non-Hilbert Real Data #################
# load data:
data("macaques")
# number of femala and male Macaca fascicularis:
table(macaques[["group"]])
# calculate Riemannian shape distance matrix:
Dmat <- nhdist(macaques[["x"]], method = "riemann")
# hypothesis test with BD:
bd.test(x = Dmat, R = 99, size = c(9, 9), dst = TRUE)

################  K-sample Test  #################
n <- 150
bd.test(rnorm(n), size = rep(50, 3))
# alternative input method:
x <- lapply(rep(50, 3), rnorm)
bd.test(x)

}
\references{
Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. (2017) Ball divergence: nonparametric two sample test, \emph{The Annals of Statistics}, to appear
}
\seealso{
\code{\link{bd}}
}
\author{
XueQin Wang, WenLiang Pan, HePing Zhang, Yuan Tian
}
