<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ball Divergence statistic — bd • Ball</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ball Divergence statistic — bd"><meta name="description" content="Compute Ball Divergence statistic, which is a generic dispersion measure in Banach spaces."><meta property="og:description" content="Compute Ball Divergence statistic, which is a generic dispersion measure in Banach spaces."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Ball</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Ball.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bd_gwas.html">`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Mamba413/Ball/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ball Divergence statistic</h1>
      <small class="dont-index">Source: <a href="https://github.com/Mamba413/Ball/tree/master/R-package/R/bd.R" class="external-link"><code>R/bd.R</code></a></small>
      <div class="d-none name"><code>bd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute Ball Divergence statistic, which is a generic dispersion measure in Banach spaces.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bd</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num.threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  kbd.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"maxsum"</span>, <span class="st">"max"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector, matrix, data.frame, or a list containing at least two numeric vectors, matrices, or data.frames.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a numeric vector, matrix, data.frame.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>if <code>distance = TRUE</code>, the elements of <code>x</code> will be considered as a distance matrix. Default: <code>distance = FALSE</code>.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>a vector recording sample size of each group.</p></dd>


<dt id="arg-num-threads">num.threads<a class="anchor" aria-label="anchor" href="#arg-num-threads"></a></dt>
<dd><p>number of threads. If <code>num.threads = 0</code>, then all of available cores will be used. Default <code>num.threads = 0</code>.</p></dd>


<dt id="arg-kbd-type">kbd.type<a class="anchor" aria-label="anchor" href="#arg-kbd-type"></a></dt>
<dd><p>a character string specifying the \(K\)-sample Ball Divergence test statistic,
must be one of <code>"sum"</code>, <code>"summax"</code>, or <code>"max"</code>. Any unambiguous substring can be given.
Default <code>kbd.type = "sum"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt><code>bd </code></dt>
<dd><p>Ball Divergence statistic</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given the samples not containing missing values, <code>bd</code> returns Ball Divergence statistics.
If we set <code>distance = TRUE</code>, arguments <code>x</code>, <code>y</code> can be a <code>dist</code> object or a
symmetric numeric matrix recording distance between samples;
otherwise, these arguments are treated as data.</p>
<p>Ball divergence statistic measure the distribution difference of two datasets in Banach spaces.
The Ball divergence statistic is proven to be zero if and only if two datasets are identical.</p>
<p>The definition of the Ball Divergence statistics is as follows.
Given two independent samples \( \{x_{1}, \ldots, x_{n}\} \) with the associated probability measure \(\mu\) and
\( \{y_{1}, \ldots, y_{m}\} \) with \(\nu\), where the observations in each sample are <em>i.i.d</em>.
Let \(\delta(x,y,z)=I(z\in \bar{B}(x, \rho(x,y)))\),
where \(\delta(x,y,z)\) indicates whether \(z\) is located in the closed ball \(\bar{B}(x, \rho(x,y))\)
with center \(x\) and radius \(\rho(x, y)\).
We denote:
$$
A_{ij}^{X}=\frac{1}{n}\sum_{u=1}^{n}{\delta(X_i,X_j,X_u)}, \quad A_{ij}^{Y}=\frac{1}{m}\sum_{v=1}^{m}{\delta(X_i,X_j,Y_v)},
$$
$$
C_{kl}^{X}=\frac{1}{n}\sum_{u=1}^{n}{\delta(Y_k,Y_l,X_u)}, \quad C_{kl}^{Y}=\frac{1}{m}\sum_{v=1}^{m}{\delta(Y_k,Y_l,Y_v)}.
$$
\(A_{ij}^X\) represents the proportion of samples \( \{x_{1}, \ldots, x_{n}\} \) located in the
ball \(\bar{B}(X_i,\rho(X_i,X_j))\) and \(A_{ij}^Y\) represents the proportion of samples \( \{y_{1}, \ldots, y_{m}\} \)
located in the ball \(\bar{B}(X_i,\rho(X_i,X_j))\).
Meanwhile, \(C_{kl}^X\) and \(C_{kl}^Y\) represent the corresponding proportions located in the ball \(\bar{B}(Y_k,\rho(Y_k,Y_l))\).
The Ball Divergence statistic is defined as:
$$D_{n,m}=A_{n,m}+C_{n,m}$$</p>
<p>Ball Divergence can be generalized to the <em>K</em>-sample test problem. Suppose we
have \(K\) group samples, each group include \(n_{k}\) samples.
The definition of \(K\)-sample Ball Divergence statistic could be
to directly sum up the two-sample Ball Divergence statistics of all sample pairs (<code>kbd.type = "sum"</code>)
$$\sum_{1 \leq k &lt; l \leq K}{D_{n_{k},n_{l}}},$$
or to find one sample with the largest difference to the others (<code>kbd.type = "maxsum"</code>)
$$\max_{t}{\sum_{s=1, s \neq t}^{K}{D_{n_{s}, n_{t}}},}$$
to aggregate the \(K-1\) most significant different two-sample Ball Divergence statistics (<code>kbd.type = "max"</code>)
$$\sum_{k=1}^{K-1}{D_{(k)}},$$
where \(D_{(1)}, \ldots, D_{(K-1)}\) are the largest \(K-1\) two-sample Ball Divergence statistics among
\(\{D_{n_s, n_t}| 1 \leq s &lt; t \leq K\}\). When \(K=2\),
the three types of Ball Divergence statistics degenerate into two-sample Ball Divergence statistic.</p>
<p>See <code><a href="bd.test.html">bd.test</a></code> for a test of distribution equality based on the Ball Divergence.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Ann. Statist. 46 (2018), no. 3, 1109–1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bd.test.html">bd.test</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">############# Ball Divergence #############</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bd</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bd.constant </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.01989856 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jin Zhu, Wenliang Pan, Junhao Zhu, Yuan Tian, Weinan Xiao, Chengfeng Liu, Ruihuang Liu, Yue Hu, Hongtu Zhu, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

