<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests â€¢ Ball</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests">
<meta property="og:description" content="Ball">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ball</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Ball.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bd_gwas.html">`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Mamba413/Ball/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bd_gwas_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>bd.gwas.test</code>: Fast Ball Divergence Test for Multiple Hypothesis Tests</h1>
                        <h4 data-toc-skip class="author">Yue Hu, Jin Zhu</h4>
            
            <h4 data-toc-skip class="date">2021/8/25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Mamba413/Ball/tree/master/R-package/../vignettes/bd_gwas.Rmd" class="external-link"><code>../vignettes/bd_gwas.Rmd</code></a></small>
      <div class="hidden name"><code>bd_gwas.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <span class="math inline">\(K\)</span>-sample Ball Divergence (KBD) is a nonparametric method to test the differences between <span class="math inline">\(K\)</span> probability distributions. It is specially designed for metric-valued and imbalanced data, which is consistent with the characteristics of the GWAS data. It is computationally intensive for a large GWAS dataset because of the ultra-high dimensionality of the data. Therefore, a fast KBD Test for GWAS data implemented in function <code>bd.gwas.test</code> is developed and programmed to accelerate the computational speed.</p>
</div>
<div class="section level2">
<h2 id="faster-implementation-quick-start">Faster implementation: quick start<a class="anchor" aria-label="anchor" href="#faster-implementation-quick-start"></a>
</h2>
<p>We use a synthetic data to demonstrate the usage of <code>bd.gwas.test</code>. In this example, phenotype data are generated from three multivariate normal distributions with the same dimension but heterogeneous mean and covariance matrix. The three multivariate normal distributions are: (i). <span class="math inline">\(N\sim(\mu, \Sigma^{(1)})\)</span>, (ii) <span class="math inline">\(N \sim (\mu + 0.1 \times d, \Sigma^{(2)})\)</span>, and (iii) <span class="math inline">\(N \sim (\mu + 0.1 \times d, \Sigma^{(3)})\)</span>. Here, the mean <span class="math inline">\(\mu\)</span> is set to <span class="math inline">\(\textbf{0}\)</span> and the covariance matrix covariance matrices follow the auto-regressive structure with some perturbations: <span class="math display">\[\Sigma_{ij}^{(1)}=\rho^{|i-j|}, ~~ \Sigma^{(2)}_{ij}=(\rho-0.1 \times d)^{|i-j|}, ~~ \Sigma^{3}_{ij}=(\rho+0.1 \times d)^{|i-j|}.\]</span> The dimension of phenotype <span class="math inline">\(k\)</span> is fixed as 100.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span>

<span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">snp_num</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">freq0</span> <span class="op">&lt;-</span> <span class="fl">0.75</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2021</span><span class="op">)</span>

<span class="va">ar1</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">p</span>, <span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> 
<span class="op">{</span>
    <span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">Sigma</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rho</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="va">j</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">mean0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">k</span><span class="op">)</span>
<span class="va">mean1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">d</span>, <span class="va">k</span><span class="op">)</span>
<span class="va">mean2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">d</span>, <span class="va">k</span><span class="op">)</span>

<span class="va">cov0</span> <span class="op">&lt;-</span> <span class="fu">ar1</span><span class="op">(</span>p <span class="op">=</span> <span class="va">k</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="fu">ar1</span><span class="op">(</span>p <span class="op">=</span> <span class="va">k</span>, rho <span class="op">=</span> <span class="va">rho</span> <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="fu">ar1</span><span class="op">(</span>p <span class="op">=</span> <span class="va">k</span>, rho <span class="op">=</span> <span class="va">rho</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">freq0</span> <span class="op">^</span> <span class="fl">2</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">freq0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">freq0</span><span class="op">)</span>
<span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">num</span> <span class="op">*</span> <span class="va">p1</span><span class="op">)</span>
<span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">num</span> <span class="op">*</span> <span class="va">p2</span><span class="op">)</span>
<span class="va">n3</span> <span class="op">&lt;-</span> <span class="va">num</span> <span class="op">-</span> <span class="va">n1</span> <span class="op">-</span> <span class="va">n2</span>
<span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n1</span>, mean <span class="op">=</span> <span class="va">mean0</span>, sigma <span class="op">=</span> <span class="va">cov0</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n2</span>, mean <span class="op">=</span> <span class="va">mean1</span>, sigma <span class="op">=</span> <span class="va">cov1</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n3</span>, mean <span class="op">=</span> <span class="va">mean2</span>, sigma <span class="op">=</span> <span class="va">cov2</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##             [,1]       [,2]       [,3]       [,4]       [,5]       [,6]</span>
<span class="co">## [1,]  0.07039579  0.6100092  0.5546911  0.5346480  0.5785020 -1.3470882</span>
<span class="co">## [2,] -0.19620313  0.2196482 -0.2968494 -0.7916355 -1.3371275 -0.5766259</span>
<span class="co">## [3,] -0.18575434 -1.4601779 -1.2635876 -0.8933793 -0.9336481 -0.5277624</span>
<span class="co">## [4,]  1.56843201  1.6330457  1.8725853  0.8344465  0.5674250 -0.3928510</span>
<span class="co">## [5,] -0.54939765  0.1602176  0.4325440 -0.1750343  0.5231533 -1.0931093</span>
<span class="co">## [6,] -0.19665796 -1.3788672 -0.6887342 -1.2731113 -0.6638883  0.0764279</span></code></pre>
<p>The number of SNPs is fixed as <span class="math inline">\(200\)</span> and the sample size is set to <span class="math inline">\(100\)</span>. The sample sizes of the three groups follow the transmission ratio: <span class="math display">\[n_1:n_2:n_3 \approx p^2:2pq:q^2,(p+q=1,n_1+n_2+n_3=100).\]</span> Here, <span class="math inline">\(p\)</span> is set to be <span class="math inline">\(0.75\)</span>, representing a scenario that close to the real data. <span class="math inline">\(d\)</span> is a user-specific positive integer, indicating the differences between the three probability distributions. Here, we use <span class="math inline">\(d=3\)</span>, aiming to show that the SNP which matched with the distribution can be identified, even when the differences between distribution is small.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">effect_snp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n2</span><span class="op">)</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">n3</span><span class="op">)</span><span class="op">)</span>
<span class="va">noise_snp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="va">snp_num</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>
    <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,
    size <span class="op">=</span> <span class="va">num</span>,
    replace <span class="op">=</span> <span class="cn">TRUE</span>,
    prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">p1</span> <span class="op">-</span> <span class="va">p2</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">snp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">effect_snp</span>, <span class="va">noise_snp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">snp</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      effect_snp          </span>
<span class="co">## [1,]          0 1 0 0 0 0</span>
<span class="co">## [2,]          0 1 1 1 0 0</span>
<span class="co">## [3,]          0 0 0 1 0 0</span>
<span class="co">## [4,]          0 0 1 0 2 0</span>
<span class="co">## [5,]          0 1 1 0 0 0</span>
<span class="co">## [6,]          0 1 1 1 1 0</span></code></pre>
<p>Given the synthetic dataset <code>x</code> and <code>snp</code>, multiple KBD tests is conducted by:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mamba413.github.io/Ball/" class="external-link">Ball</a></span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bd.gwas.test.html">bd.gwas.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, snp <span class="op">=</span> <span class="va">snp</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## =========== Pre-screening SNPs ===========</span>
<span class="co">## Refining SNP... Progress: 1/1. </span>
<span class="co">## Refined p-value: 0.0000499975, cost time: 4 (s).</span></code></pre>
<p>And we present the SNPs that is significant:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 8</span>
<span class="co">##  $ statistic                 : num [1:200] 4.218 0.876 1.881 1.104 1.143 ...</span>
<span class="co">##  $ permuted.statistic        :'data.frame':  20000 obs. of  1 variable:</span>
<span class="co">##   ..$ g3: num [1:20000] 0.819 1.114 1.112 1.563 0.906 ...</span>
<span class="co">##  $ eigenvalue                : NULL</span>
<span class="co">##  $ p.value                   : num [1:200] 0.00005 0.9112 0.0577 0.60847 0.55267 ...</span>
<span class="co">##  $ refined.snp               : int 1</span>
<span class="co">##  $ refined.p.value           : num 5e-05</span>
<span class="co">##  $ refined.permuted.statistic: num [1:20000, 1] 1.216 0.857 0.988 0.937 1.37 ...</span>
<span class="co">##   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">##   .. ..$ : NULL</span>
<span class="co">##   .. ..$ : chr "SNP1"</span>
<span class="co">##  $ screening.result          :List of 5</span>
<span class="co">##   ..$ : num [1:200] 4.218 0.876 1.881 1.104 1.143 ...</span>
<span class="co">##   ..$ :'data.frame': 20000 obs. of  1 variable:</span>
<span class="co">##   .. ..$ g3: num [1:20000] 0.819 1.114 1.112 1.563 0.906 ...</span>
<span class="co">##   ..$ : num [1:200] 0.00005 0.9112 0.0577 0.60847 0.55267 ...</span>
<span class="co">##   ..$ : int [1:10000] 0 97 44 35 95 99 39 19 46 65 ...</span>
<span class="co">##   ..$ : int 0</span></code></pre>
</div>
<div class="section level2">
<h2 id="why-bd-gwas-test-is-faster">Why <code>bd.gwas.test</code> is faster?<a class="anchor" aria-label="anchor" href="#why-bd-gwas-test-is-faster"></a>
</h2>
<p>Our faster implementation for multiple testing significantly speeds up the KBD test in two aspects.</p>
<div class="section level3">
<h3 id="two-step-algorithm">Two-step algorithm<a class="anchor" aria-label="anchor" href="#two-step-algorithm"></a>
</h3>
<p>First, it uses a two-step algorithm for KBD. The algorithm first computes an empirical <span class="math inline">\(p\)</span>-value for each SNP using a modest number of permutations which gives precise enough estimates of the <span class="math inline">\(p\)</span>-values above a threshold. Then, the SNPs with first stage <span class="math inline">\(p\)</span>-values being less than the threshold are moved to the second stage for a far greater number of permutations.</p>
</div>
<div class="section level3">
<h3 id="recycle-permutation-result">Recycle permutation result<a class="anchor" aria-label="anchor" href="#recycle-permutation-result"></a>
</h3>
<p>Another key technique in <code>bd.test.gwas</code> is reusing the empirical KBDâ€™s distribution under the null hypothesis. This technique is particularly helpful for decreasing computational burden when the number of factors <span class="math inline">\(p\)</span> is very large and <span class="math inline">\(K\)</span> is a single digit. A typical case is the GWAS study, in which <span class="math inline">\(p \approx 10^4\)</span> or <span class="math inline">\(10^5\)</span> but <span class="math inline">\(K = 3\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="power-evaluation">Power evaluation<a class="anchor" aria-label="anchor" href="#power-evaluation"></a>
</h2>
<p>According to the simulations:</p>
<ul>
<li><p>the empirical type I errors of KBD are reasonably controlled around <span class="math inline">\(10^{-5}\)</span>;</p></li>
<li><p>the power of KBD increases as either the sample size or the difference between means or covariance matrices increases. The empirical power is close to <span class="math inline">\(1\)</span> when the difference between distributions is large enough.</p></li>
</ul>
<p>Furthermore, correlated responses may slightly decrease the power of the test compared to the case of independent responses. Moreover, KBD performs better when the data are not extremely imbalanced and it maintains reasonable power for the imbalanced setting.</p>
<p>Compared to other methods, KBD performs better in most of the scenarios, especially when the simulation setting is close to the real data. Moreover, KBD is more computationally efficient in identifying significant variants.</p>
<p>From Figures 1 and 3, we can notice that the power curves are similar after sample size of 500, when the minor allele frequency is not small. On the other hand, when the minor allele is rare, a larger sample size can lead to a higher power from Figures 2 and 4. The four figures show how sample size could affect the power of the KBD method, indicating that there is an inverse relationship between minor allele frequency and the sample sizes in order to get sufficient power.</p>
<!-- ![](./kbd_gwas.png) -->
<p align="center">
<img src="kbd_gwas.png" width="500" height="500"></p>
<!-- ### Summary plots of simulation results of heterogeneous settings of the KBD method             -->
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>We implement <code>bd.test.gwas</code> in Ball package for handling multiple KBD test. KBD is a powerful method that can detect the significant variants with a controllable type I error regardless if the data are balanced or not.</p>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>Yue Hu, Haizhu Tan, Cai Li, Heping Zhang. (2021). Identifying genetic risk variants associated with brain volumetric phenotypes via K-sample Ball Divergence method. Genetic Epidemiology, 1â€“11. <a href="https://doi.org/10.1002/gepi.22423" class="external-link uri">https://doi.org/10.1002/gepi.22423</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jin Zhu, Wenliang Pan, Yuan Tian, Weinan Xiao, Chengfeng Liu, Ruihuang Liu, Yue Hu, Hongtu Zhu, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
