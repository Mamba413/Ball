[{"path":"https://mamba413.github.io/Ball/TODO.html","id":null,"dir":"","previous_headings":"","what":"Ball 1.3.10","title":"Ball 1.3.10","text":"Fast bcov computation (Incompletely U-statistic, subsample centre sphere) Fast bcor computation","code":""},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"fundamental problems data mining statistical analysis : Whether distributions two samples distinct? Whether two random variables dependent? Two-sample test, designed solve first problem, important medicine, psychology, biology . instance, want know whether lifespan male female different. Thus, collect lifetime data, try figure whether ages two samples identically distributed. following images shown, distribution life span two groups look like left one, conclude lifetime identically distributed. right one, indicates likely identically distributed. Test independence, designed solve problem, also essential. following images shown, strong linear relation Y X1, X2 seems nothing Y. X1 taken account added regression model Y, studied carefully order confirm correlation mechanism Y. Ball package provides solution independence test, two-sample test even K-sample test. Moreover, generic non-parametric sure independence screening procedure also implemented deal ultra high dimensional data. three core functions : bd.test: examine whether K(K‚â•2)K(K \\geq 2) univariate multivariate distributions identical. bcov.test: test whether univariate multivariate variables related . bcorsis: carry sure independence screening procedure pick variables potentially related response.","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"cran-version","dir":"Articles","previous_headings":"Quick Start > Installation","what":"CRAN version","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"install Ball R package CRAN, just run:","code":"install.packages(\"Ball\")"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"github-version","dir":"Articles","previous_headings":"Quick Start > Installation","what":"Github version","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"install development version GitHub, run: Windows user need install Rtools first.","code":"library(devtools) install_github(\"Mamba413/Ball\", build_vignettes = TRUE)"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"quick-start-univariate-two-sample-test","dir":"Articles","previous_headings":"Quick Start","what":"Quick Start: Univariate Two-sample Test","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, generate two normal random variables different location parameter: X‚àºN(0,1),Y‚àºN(1,1)X \\sim N(0,1), Y \\sim N(1, 1) use bd.test perform two-sample test determine whether two samples come distribution. result bd.test p-value < 0.05, means reject null hypothesis, conclude two samples come different distribution. Consequently, hypothesis test result concordant data generation mechanism.","code":"x <- rnorm(50) y <- rnorm(50, mean = 1) # plot(density(x), xlim = c(-5, 5)) # lines(density(y), col = 'red') ## TOFIX # bd.test(x = x, y = y)"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"quick-start-multivariate-two-sample-test","dir":"Articles","previous_headings":"Quick Start","what":"Quick Start: Multivariate Two-sample Test","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, demonstrate perform test whether two multivariate distributions identical. generate two random samples size 50, sampled two different multivariate normal distributions: X‚àºN(ŒºX,I2√ó2),Y‚àºN(ŒºY,I2√ó2)X \\sim N(\\mu_{X},I_{2 \\times 2}), Y \\sim N(\\mu_{Y}, I_{2 \\times 2})ŒºX=(0,0),ŒºY=(1,1)\\mu_{X} = (0,0), \\mu_{Y} = (1,1) use bd.test test whether two multivariate random samples identically distributed. result bd.test p-value < 0.05, conclude two samples identically distributed.","code":"x <- matrix(rnorm(100), nrow = 50, ncol = 2) y <- matrix(rnorm(100, mean = 3), nrow = 50, ncol = 2) bd.test(x = x, y = y) #  #   2-sample Ball Divergence Test (Permutation) #  # data:  x and y  # number of observations = 100, group sizes: 50 50 # replicates = 99, weight: constant # bd.constant = 0.56944, p-value = 0.01 # alternative hypothesis: distributions of samples are distinct"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"quick-start-univariate-test-of-independence","dir":"Articles","previous_headings":"Quick Start","what":"Quick Start: Univariate Test of Independence","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, use ‚ÄúW-shape‚Äù data WIKI demonstrate perform univariate test independence bcov.test . generate dataset containing 50 samples. Obviously, XX related YY, relationship non-linear. use bcov.test perform test independence XX YY. result bcov.test p-value < 0.05, conclude XX YY independent, means kind correlation X Y.","code":"# generate random perturbation: noise <- runif(50, min = -0.3, max = 0.3) x <- runif(50, 0, 4*pi) y <- cos(x) + noise # plot(x, y) bcov.test(x = x, y = y) #  #   Ball Covariance test of independence (Permutation) #  # data:  x and y # number of observations = 50 # replicates = 99, weight: constant # bcov.constant = 0.0019181, p-value = 0.01 # alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"quick-start-multivariate-test-of-independence","dir":"Articles","previous_headings":"Quick Start","what":"Quick Start: Multivariate Test of Independence","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"multivariate independence test, demonstrate usage bcov.test following example: X=(x1,x2)X=(x_{1}, x_{2}) come bivariate normal distribution. relation YY XX :Y=2sin(x1+x2)+œµ,œµ‚àºU(‚àí0.1,0.1)Y=2\\sin(x_{1} + x_{2})+ \\epsilon, \\quad \\epsilon \\sim U(-0.1, 0.1) use bcov.test perform multivariate independence test: result bcov.test p-value < 0.05, conclude multivariate random variable XX YY associated.","code":"x <- matrix(runif(50 * 2, -pi, pi), nrow = 50, ncol = 2) noise <- runif(50, min = -0.1, max = 0.1) y <- 2 * sin(x[,1] + x[,2]) + noise bcov.test(x = x, y = y, weight = \"prob\") #  #   Ball Covariance test of independence (Permutation) #  # data:  x and y # number of observations = 50 # replicates = 99, weight: probability # bcov.probability = 0.03981, p-value = 0.03 # alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"advance-features","dir":"Articles","previous_headings":"","what":"Advance Features","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"features implemented help analyse diverse complicated real data.","code":""},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"non-hilbert-space-data","dir":"Articles","previous_headings":"Advance Features","what":"Non-Hilbert Space Data","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"scientific research, always deal Non-Hilbert space data. However, traditional statistical inference methods usually depend assumptions, able perform statistical inference kind data directly. Whereas ball divergence doesn‚Äôt depend assumptions needed traditional statistical inference method, ‚Äôs able perform two-sample test data Non-Hilbert space. demonstrate use Ball package perform statistical inference data Non-Hilbert space three examples:","code":""},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"example-1-simulated-von-mises-fisher-distribution-data","dir":"Articles","previous_headings":"Advance Features > Non-Hilbert Space Data","what":"Example 1: Simulated von Mises-Fisher distribution data","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"distribution data shown following image:  image, black dots (XX) red dots (YY) respectively represent two group simulated data different distributions. distributions denoted : X‚àºM(ŒºX,Œ∫),Y‚àºM(ŒºY,Œ∫)X \\sim M(\\mu_{X}, \\kappa), Y \\sim M(\\mu_{Y}, \\kappa) MM denotes von Mises-Fisher distribution, ŒºX=(1,0,0),ŒºY=(1,1,1)\\mu_{X} = (1, 0, 0), \\mu_{Y} = (1, 1, 1) orientation parameter von Mises-Fisher distribution, Œ∫=3\\kappa = 3 denotes aggregation parameter. can tell image , red dots black dots identically distributed. However, tough task traditional statistical method distinguish distribution conventional data Hilbert space. Fortunately, since computation sample version ball divergence (ball covariance) involves calculate distance matrix counting number samples located ball, can obtain empirical ball divergence long can define distance metric observations. Therefore, ball divergence still work example. apply ball divergence data carrying following step. First, calculate geodesic distance matrix data, implemented function . Later, pass distance matrix arguments let , , . detailed solution demonstrated : example, firstly calculate geodesic distance matrix using nhdist function Ball package. , pass dx arguments x set distance = TRUE indicate x parameter distance matrix. Meanwhile, set size sample size = c(150, 150) set replication times num.permutations = 99. result p-value < 0.05, means red dots black dots identically distributed.","code":"# load data: data(\"bdvmf\") # calculate geodesic distance between samples: dx <- nhdist(bdvmf[[\"x\"]], method = \"geodesic\") # sample sizes in each group: 150, 150 # Two-Sample Test based on BD : bd.test(x = dx, size = c(150, 150), num.permutations = 99, distance = TRUE) #  #   2-sample Ball Divergence Test (Permutation) #  # data:  dx  # number of observations = 300, group sizes: 150 150 # replicates = 99, weight: constant # bd.constant = 0.14483, p-value = 0.01 # alternative hypothesis: distributions of samples are distinct"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"example-2-macaques-data","dir":"Articles","previous_headings":"Advance Features > Non-Hilbert Space Data","what":"Example 2: Macaques Data","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Based Macaques data provided dryden, scientists want figure whether differences shape skull Macaques different genders. similar way, can calculate distance matrix data transform problem two-sample test can solved BD. Riemann shape distance always used describe distance shape data. setting method = ‚Äúriemann‚Äù nhdist function, able calculate riemann shape distance shape data. detailed procedure demonstrated : p-value 0.05, means skull shape differs male macaques female macaques.","code":"# load data: data(\"macaques\") # number of femala and male Macaca fascicularis: # table(macaques[[\"group\"]])  # f: 9; m: 9 # calculate Riemannian shape distance matrix: dx <- nhdist(macaques[[\"x\"]], method = \"riemann\") # hypothesis test with BD: bd.test(x = dx, num.permutations = 99, size = c(9, 9), distance = TRUE) #  #   2-sample Ball Divergence Test (Permutation) #  # data:  dx  # number of observations = 18, group sizes: 9 9 # replicates = 99, weight: constant # bd.constant = 0.1922, p-value = 0.03 # alternative hypothesis: distributions of samples are distinct"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"example-3-arcticlake-data","dir":"Articles","previous_headings":"Advance Features > Non-Hilbert Space Data","what":"Example 3: ArcticLake Data","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"bcov.test related calculating distance samples two multivariate random variables. Therefore, can examine independence assumption employing bcov.test non-Hilbert space real data long obtain distance matrix samples. take data Book, Statistical Analysis Compositional Data, example demonstrate use bcov.test determine dependence non-Hilbert space data. Scientists collect Sand, silt clay compositions 39 sediment samples different water depth Arctic lake. want figure whether compositions sediment samples different water depth identical . achieve goal, use bcov.test perform test independence. detailed procedure demonstrated : first calculate distance matrix dy dx. , pass dx arguments x, dy arguments y, set replication times num.permutations = 99, distance = TRUE indicate x y parameters distance matrices. result shows p-value less 0.05, usual significance level, conclude compositions sediment associated water depth. example , use square root transformed data calculate geodesic distance measurement difference different compositions sediment samples (Dy). Meanwhile, use euclidean distance measure difference different water depth (Dx). different data, can use different measurements cope different features data.","code":"data(\"ArcticLake\") # Distance matrix between y: dy <- nhdist(ArcticLake[[\"x\"]], method = \"compositional\") # Distance matrix between x: dx <- dist(ArcticLake[[\"depth\"]]) # hypothesis test with BCov: bcov.test(x = dx, y = dy, num.permutations = 99, distance = TRUE) #  #   Ball Covariance test of independence (Permutation) #  # data:  dx and dy # number of observations = 39 # replicates = 99, weight: constant # bcov.constant = 0.0083848, p-value = 0.01 # alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"k-sample-test","dir":"Articles","previous_headings":"Advance Features","what":"K-Sample Test","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"bd.test also applicable testing multiple samples. generate three random normal samples size 50, sampled normal distribution. example, use bd.test test whether samples identically distributed. result shown, p-value>0.05, means can‚Äôt reject null hypothesis. can also utilize bd.test deal KK-Sample problem non-Hilbert space following aforementioned procedure. time, remember assign size vector parameter size arguments set distance = TRUE.","code":"n <- 150 bd.test(rnorm(n), size = rep(50, 3)) #  #   3-sample Ball Divergence Test (Permutation) #  # data:  rnorm(n)  # number of observations = 150, group sizes: 50 50 50 # replicates = 99, weight: constant, kbd.type: sum # kbd.sum.constant = 0.028364, p-value = 0.64 # alternative hypothesis: distributions of samples are distinct"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"weighted-ball-covariance-test","dir":"Articles","previous_headings":"Advance Features","what":"Weighted Ball Covariance Test","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Pan et. al(2017) show weighted ball covariance based independence test statistical consistent dependence alternatives without moment conditions times superior standard version ball covariance. implemented weighted ball covariance test Ball package can employ data analysis just setting weight = TRUE bcov.test. Take ArcticLake data example:","code":"data(\"ArcticLake\") Dy <- nhdist(ArcticLake[[\"x\"]], method = \"compositional\") Dx <- dist(ArcticLake[[\"depth\"]]) # hypothesis test with weighted BCov: bcov.test(x = Dx, y = Dy, num.permutations = 99,            distance = TRUE, weight = \"constant\") #  #   Ball Covariance test of independence (Permutation) #  # data:  Dx and Dy # number of observations = 39 # replicates = 99, weight: constant # bcov.constant = 0.0083848, p-value = 0.01 # alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"ball-covariance-mutual-independence-test","dir":"Articles","previous_headings":"Advance Features","what":"Ball Covariance Mutual Independence Test","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Apart relationships two random variables, another important dependence concept set variables mutual (joint) independence, says two disjoint subsets variables independent . instance, know investigate whether air temperature, soil temperature, humidity, wind evaporation correlated. natural extend ball covariance measure mutual independence KK random variables.    importantly, Mutual independence test based ball covariance implemented Ball package. give two simply example following demonstrate usage. first example, X,œµ1,œµ2X, \\epsilon_{1}, \\epsilon_{2} independent standard normal distribution N(0,1)N(0,1), Y=max(X,0)+œµ1,Z=min(X,0)+œµ2Y = \\max(X, 0) + \\epsilon_{1}, \\; Z = \\min(X, 0) + \\epsilon_{2} Second example, W,X,Y,ZW, X, Y, Z connected latent random variable H‚àºN(0,1)H \\sim N(0,1), W=H2;X=|H|,Y=min(H,0)W = H^{2}; X = |H|, Y = min(H, 0)Z=(Z1,Z2),Z1=(H<0.5)H,Z2=(H>‚àí0.5)HZ = (Z_{1}, Z_{2}), Z_{1}=(H<0.5)H, Z_{2}=(H>-0.5)H bind data list example1 example2 pass arguments x bcov.test carry ball covariance mutual independence test. hypothesis test result two examples show p-value < 0.05, coinciding simulation setting.","code":"x <- rnorm(50) y <- (x > 0) * x + rnorm(50) z <- (x <= 0) * x + rnorm(50) example1 <- list(x, y, z) h <- rnorm(50) w <- (h)^2 x <- abs(h) y <- h * (h < 0) z1 <- h * (h < 0.5) z2 <- h * (h > -0.5) z <- cbind(z1, z2) example2 <- list(w, x, y, z) bcov.test(x = example1, num.permutations = 199) #  #   Ball Covariance test of mutual independence (Permutation) #  # data:  example1 # number of observations = 50 # replicates = 199, weight: constant # bcov.constant = 0.0026544, p-value = 0.005 # alternative hypothesis: random variables are dependent bcov.test(x = example2, num.permutations = 199) #  #   Ball Covariance test of mutual independence (Permutation) #  # data:  example2 # number of observations = 50 # replicates = 199, weight: constant # bcov.constant = 0.036585, p-value = 0.005 # alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"ball-correlation-based-sure-independence-screening","dir":"Articles","previous_headings":"Advance Features","what":"Ball Correlation Based Sure Independence Screening","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Recent technological advances made possible collect ultra high-dimensional data. common feature data number variables pp generally much larger sample sizes nn. instance, number gene expression profiles order tens thousands number patient samples order tens hundreds. However, traditional variable selection algorithms LASSO, SCAD may perform well due statistical inaccuracy, algorithmic instability. new framework, sure independence screening (SIS), proposed tackle challenges . SIS tries filtering features marginal correlation response, hence effectively reducing dimensionality pp moderate scale performing statistical algorithm feasible. BCor-SIS, generic non-parametric sure independence screening procedure based ball correlation, able pick explanatory variables related response. linear, non-linear linear interaction effect relationship can captured BCor-SIS even though data heavy tail existing outliers. importantly, BCor-SIS able retain important features model probability tending 1 mild conditions.","code":""},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"bcor-sis-quick-start-example","dir":"Articles","previous_headings":"Advance Features > Ball Correlation Based Sure Independence Screening","what":"BCor-SIS: Quick Start Example","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, utilize bcorsis function carry BCor-SIS procedure. generate 150 high dimensional instances 3000 independent standard gaussian explanatory variables XX univariate response variable YY. relation YY XX :Y=3X1+5X32+œµ,œµ‚àºN(0,1)Y=3 X_{1} + 5 X_{3}^{2} + \\epsilon, \\quad \\epsilon \\sim N(0, 1) perform BCor-SIS procedure display top 5 variables index selected BCor-SIS. bcorsis result shows first third variable two important variables 3000 explanatory variables consistent simulation settings.","code":"set.seed(1) n <- 150 p <- 3000 x <- matrix(rnorm(n * p), nrow = n) noise <- rnorm(n) y <- 3*x[, 1] + 5*(x[, 3])^2 + noise ## TOFIX # res <- bcorsis(y = y, x = x) # head(res[[1]], n = 5)"},{"path":"https://mamba413.github.io/Ball/articles/Ball.html","id":"extension-of-bcor-sis-a-censored-survival-data","dir":"Articles","previous_headings":"Advance Features > Ball Correlation Based Sure Independence Screening","what":"Extension of BCor-SIS: A Censored Survival Data","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Survival analysis commonly used method analysis censored data biological death mechanical failure, usually subject censoring. main goal survival analysis study dependence survival time TT covariate variables X,X‚ààRpX, X \\R^{p}. remarkable development modern technology, huge amount covariate information microarray SNP data collected. Consequently, SIS procedure designed censored survival data need. Pan et al(2017) proposed extend BCor-SIS procedure able selected significant variables censored data. implement BCor-SIS procedure survival data Ball package use publicly lung cancer genomic data Chemores Cohort Study demonstrate usage. data outcome ‚ÄúDisease-Free Survival Time‚Äù. Patients followed first relapse occurred administrative censoring. genomic dataset, expression levels mRNA, miRNA well clinical variables 123 samples included. Moreover, dataset include 944 biological covariates 1056 artificial standard gaussian variables independence response. employ extension Bcor-SIS data hunt efficient covariates demonstrate detailed procedure following. first pass covariates censored information arugments x y, set method = ‚Äúsurvival‚Äù indicate y considered survival status containing event time censored status. BCor-SIS asserts hsa.miR.564, corresponding gene MIR564, strongly relevant disease-free survival status. conclusion highly coincident statement public literature.","code":"## TOFIX # result <- bcorsis(x = genlung[[\"covariate\"]],  #                   y = genlung[[\"survival\"]],  #                   d = \"small\", method = \"survival\") # top_gene <- colnames(genlung[[\"covariate\"]])[result[[\"ix\"]]] # head(top_gene, n = 1)"},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"KK-sample Ball Divergence (KBD) nonparametric method test differences KK probability distributions. specially designed metric-valued imbalanced data, consistent characteristics GWAS data. computationally intensive large GWAS dataset ultra-high dimensionality data. Therefore, fast KBD Test GWAS data implemented function bd.gwas.test developed programmed accelerate computational speed.","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"faster-implementation-quick-start","dir":"Articles","previous_headings":"","what":"Faster implementation: quick start","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"use synthetic data demonstrate usage bd.gwas.test. example, phenotype data generated three multivariate normal distributions dimension heterogeneous mean covariance matrix. three multivariate normal distributions : (). N‚àº(Œº,Œ£(1))N\\sim(\\mu, \\Sigma^{(1)}), (ii) N‚àº(Œº+0.1√ód,Œ£(2))N \\sim (\\mu + 0.1 \\times d, \\Sigma^{(2)}), (iii) N‚àº(Œº+0.1√ód,Œ£(3))N \\sim (\\mu + 0.1 \\times d, \\Sigma^{(3)}). , mean Œº\\mu set ùüé\\textbf{0} covariance matrix covariance matrices follow auto-regressive structure perturbations: Œ£ij(1)=œÅ|‚àíj|,Œ£ij(2)=(œÅ‚àí0.1√ód)|‚àíj|,Œ£ij3=(œÅ+0.1√ód)|‚àíj|.\\Sigma_{ij}^{(1)}=\\rho^{|-j|}, ~~ \\Sigma^{(2)}_{ij}=(\\rho-0.1 \\times d)^{|-j|}, ~~ \\Sigma^{3}_{ij}=(\\rho+0.1 \\times d)^{|-j|}. dimension phenotype kk fixed 100. number SNPs fixed 200200 sample size set 100100. sample sizes three groups follow transmission ratio: n1:n2:n3‚âàp2:2pq:q2,(p+q=1,n1+n2+n3=100).n_1:n_2:n_3 \\approx p^2:2pq:q^2,(p+q=1,n_1+n_2+n_3=100). , pp set 0.750.75, representing scenario close real data. dd user-specific positive integer, indicating differences three probability distributions. , use d=3d=3, aiming show SNP matched distribution can identified, even differences distribution small. Given synthetic dataset x snp, multiple KBD tests conducted : present SNPs significant:","code":"library(mvtnorm)  num <- 100 snp_num <- 200 k <- 100 rho <- 0.5 freq0 <- 0.75 d <- 3  set.seed(2021)  ar1 <- function (p, rho = 0.5)  {     Sigma <- matrix(0, p, p)     for (i in 1:p) {         for (j in 1:p) {             Sigma[i, j] <- rho^(abs(i - j))         }     }     return(Sigma) }  mean0 <- rep(0, k) mean1 <- rep(0.1 * d, k) mean2 <- rep(-0.1 * d, k)  cov0 <- ar1(p = k, rho = rho) cov1 <- ar1(p = k, rho = rho - 0.1 * d) cov2 <- ar1(p = k, rho = rho + 0.1 * d)  p1 <- freq0 ^ 2 p2 <- 2 * freq0 * (1 - freq0) n1 <- round(num * p1) n2 <- round(num * p2) n3 <- num - n1 - n2 x0 <- rmvnorm(n1, mean = mean0, sigma = cov0) x1 <- rmvnorm(n2, mean = mean1, sigma = cov1) x2 <- rmvnorm(n3, mean = mean2, sigma = cov2) x <- rbind(x0, x1, x2) head(x[, 1:6]) ##             [,1]       [,2]       [,3]       [,4]       [,5]       [,6] ## [1,]  0.07039579  0.6100092  0.5546911  0.5346480  0.5785020 -1.3470882 ## [2,] -0.19620313  0.2196482 -0.2968494 -0.7916355 -1.3371275 -0.5766259 ## [3,] -0.18575434 -1.4601779 -1.2635876 -0.8933793 -0.9336481 -0.5277624 ## [4,]  1.56843201  1.6330457  1.8725853  0.8344465  0.5674250 -0.3928510 ## [5,] -0.54939765  0.1602176  0.4325440 -0.1750343  0.5231533 -1.0931093 ## [6,] -0.19665796 -1.3788672 -0.6887342 -1.2731113 -0.6638883  0.0764279 effect_snp <- c(rep(0, n1), rep(1, n2),                 rep(2, n3)) noise_snp <- sapply(2:snp_num, function(j) {   sample(     0:2,     size = num,     replace = TRUE,     prob = c(p1, p2, 1 - p1 - p2)   ) }) snp <- cbind(effect_snp, noise_snp) head(snp[, 1:6]) ##      effect_snp           ## [1,]          0 1 0 0 0 0 ## [2,]          0 1 1 1 0 0 ## [3,]          0 0 0 1 0 0 ## [4,]          0 0 1 0 2 0 ## [5,]          0 1 1 0 0 0 ## [6,]          0 1 1 1 1 0 library(Ball) res <- bd.gwas.test(x = x, snp = snp) ## =========== Pre-screening SNPs =========== ## Refining SNP... Progress: 1/1.  ## Refined p-value: 0.0000499975, cost time: 2 (s). str(res) ## List of 8 ##  $ statistic                 : num [1:200] 4.218 0.876 1.881 1.104 1.143 ... ##  $ permuted.statistic        :'data.frame':  20000 obs. of  1 variable: ##   ..$ g3: num [1:20000] 0.819 1.114 1.112 1.563 0.906 ... ##  $ eigenvalue                : NULL ##  $ p.value                   : num [1:200] 0.00005 0.9112 0.0577 0.60847 0.55267 ... ##  $ refined.snp               : int 1 ##  $ refined.p.value           : num 5e-05 ##  $ refined.permuted.statistic: num [1:20000, 1] 1.216 0.857 0.988 0.937 1.37 ... ##   ..- attr(*, \"dimnames\")=List of 2 ##   .. ..$ : NULL ##   .. ..$ : chr \"SNP1\" ##  $ screening.result          :List of 5 ##   ..$ : num [1:200] 4.218 0.876 1.881 1.104 1.143 ... ##   ..$ :'data.frame': 20000 obs. of  1 variable: ##   .. ..$ g3: num [1:20000] 0.819 1.114 1.112 1.563 0.906 ... ##   ..$ : num [1:200] 0.00005 0.9112 0.0577 0.60847 0.55267 ... ##   ..$ : int [1:10000] 0 97 44 35 95 99 39 19 46 65 ... ##   ..$ : int 0"},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"why-bd-gwas-test-is-faster","dir":"Articles","previous_headings":"","what":"Why bd.gwas.test is faster?","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"faster implementation multiple testing significantly speeds KBD test two aspects.","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"two-step-algorithm","dir":"Articles","previous_headings":"Why bd.gwas.test is faster?","what":"Two-step algorithm","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"First, uses two-step algorithm KBD. algorithm first computes empirical pp-value SNP using modest number permutations gives precise enough estimates pp-values threshold. , SNPs first stage pp-values less threshold moved second stage far greater number permutations.","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"recycle-permutation-result","dir":"Articles","previous_headings":"Why bd.gwas.test is faster?","what":"Recycle permutation result","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"Another key technique bd.test.gwas reusing empirical KBD‚Äôs distribution null hypothesis. technique particularly helpful decreasing computational burden number factors pp large KK single digit. typical case GWAS study, p‚âà104p \\approx 10^4 10510^5 K=3K = 3.","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"power-evaluation","dir":"Articles","previous_headings":"","what":"Power evaluation","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"According simulations: empirical type errors KBD reasonably controlled around 10‚àí510^{-5}; power KBD increases either sample size difference means covariance matrices increases. empirical power close 11 difference distributions large enough. Furthermore, correlated responses may slightly decrease power test compared case independent responses. Moreover, KBD performs better data extremely imbalanced maintains reasonable power imbalanced setting. Compared methods, KBD performs better scenarios, especially simulation setting close real data. Moreover, KBD computationally efficient identifying significant variants. Figures 1 3, can notice power curves similar sample size 500, minor allele frequency small. hand, minor allele rare, larger sample size can lead higher power Figures 2 4. four figures show sample size affect power KBD method, indicating inverse relationship minor allele frequency sample sizes order get sufficient power.","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"implement bd.test.gwas Ball package handling multiple KBD test. KBD powerful method can detect significant variants controllable type error regardless data balanced .","code":""},{"path":"https://mamba413.github.io/Ball/articles/bd_gwas.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"`bd.gwas.test`: Fast Ball Divergence Test for Multiple Hypothesis Tests","text":"Yue Hu, Haizhu Tan, Cai Li, Heping Zhang. (2021). Identifying genetic risk variants associated brain volumetric phenotypes via K-sample Ball Divergence method. Genetic Epidemiology, 1‚Äì11. https://doi.org/10.1002/gepi.22423","code":""},{"path":"https://mamba413.github.io/Ball/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jin Zhu. Author, maintainer. Wenliang Pan. Author. Junhao Zhu. Author. Yuan Tian. Author. Weinan Xiao. Author. Chengfeng Liu. Author. Ruihuang Liu. Author. Yue Hu. Author. Hongtu Zhu. Author. Heping Zhang. Author. Xueqin Wang. Author.","code":""},{"path":"https://mamba413.github.io/Ball/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zhu J, Pan W, Zheng W, Wang X (2021). ‚ÄúBall: R Package Detecting Distribution Difference Association Metric Spaces.‚Äù Journal Statistical Software, 97(6), 1‚Äì31. doi:10.18637/jss.v097.i06.","code":"@Article{,   title = {{Ball}: An {R} Package for Detecting Distribution Difference and Association in Metric Spaces},   author = {Jin Zhu and Wenliang Pan and Wei Zheng and Xueqin Wang},   journal = {Journal of Statistical Software},   year = {2021},   volume = {97},   number = {6},   pages = {1--31},   doi = {10.18637/jss.v097.i06}, }"},{"path":[]},{"path":"https://mamba413.github.io/Ball/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"fundamental problems data mining, statistical analysis, machine learning : - whether several distributions different? - whether random variables dependent? - pick useful variables/features high-dimensional data? issues can tackled using bd.test, bcov.test, bcorsis functions Ball package, respectively. enjoy following admirable advantages: - available datasets (e.g., traditional tabular data, brain shape, functional connectome, wind direction ) - insensitive outliers, distribution-free model-free; - theoretically guaranteed computationally efficient.","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/index.html","id":"cran-version","dir":"","previous_headings":"Installation","what":"CRAN version","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"install Ball R package CRAN, just run:","code":"install.packages(\"Ball\")"},{"path":"https://mamba413.github.io/Ball/index.html","id":"github-version","dir":"","previous_headings":"Installation","what":"Github version","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"install development version GitHub, run: Windows user need install Rtools first.","code":"library(devtools) install_github(\"Mamba413/Ball/R-package\", build_vignettes = TRUE)"},{"path":"https://mamba413.github.io/Ball/index.html","id":"overview-ball-package","dir":"","previous_headings":"","what":"Overview: Ball package","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Three importance functions Ball: SIS: Sure Independence Screening ISIS: Iterative Sure Independence Screening (SIS) GWAS: Genome-Wide Association Study","code":""},{"path":"https://mamba413.github.io/Ball/index.html","id":"quick-examples","dir":"","previous_headings":"","what":"Quick examples","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Take iris dataset example illustrate use bd.test bcov.test deal fundamental problems mentioned .","code":""},{"path":"https://mamba413.github.io/Ball/index.html","id":"bdtest","dir":"","previous_headings":"Quick examples","what":"bd.test","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, bd.test examines assumption Sepal.Length distributions versicolor virginica equal. assumption invalid, p-value bd.test 0.05. example, result : R output shows p-value 0.05. Consequently, can conclude Sepal.Length distribution versicolor virginica distinct.","code":"virginica <- iris[iris$Species == \"virginica\", \"Sepal.Length\"] versicolor <- iris[iris$Species == \"versicolor\", \"Sepal.Length\"] bd.test(virginica, versicolor) 2-sample Ball Divergence Test (Permutation)  data:  virginica and versicolor number of observations = 100, group sizes: 50 50 replicates = 99, weight: constant bd.constant = 0.11171, p-value = 0.01 alternative hypothesis: distributions of samples are distinct"},{"path":"https://mamba413.github.io/Ball/index.html","id":"bcovtest","dir":"","previous_headings":"Quick examples","what":"bcov.test","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"example, bcov.test investigates whether width length petal associated width length sepal. dependency really exists, p-value bcov.test 0.05. example, result show : Therefore, relationship width length sepal petal exists.","code":"sepal <- iris[, c(\"Sepal.Width\", \"Sepal.Length\")] petal <- iris[, c(\"Petal.Width\", \"Petal.Length\")] bcov.test(sepal, petal) Ball Covariance test of independence (Permutation)  data:  sepal and petal number of observations = 150 replicates = 99, weight: constant bcov.constant = 0.0081472, p-value = 0.01 alternative hypothesis: random variables are dependent"},{"path":"https://mamba413.github.io/Ball/index.html","id":"bcorsis","dir":"","previous_headings":"Quick examples","what":"bcorsis","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"generate dataset demonstrate usage bcorsis function follow. ```{r} ## simulate ultra high dimensional dataset: set.seed(1) n <- 150 p <- 3000 x <- matrix(rnorm(n * p), nrow = n) error <- rnorm(n) y <- 3 * x[, 1] + 5 * (x[, 3])^2 + error","code":""},{"path":"https://mamba413.github.io/Ball/index.html","id":"bcor-sis-procedure","dir":"","previous_headings":"","what":"BCor-SIS procedure:","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"res <- bcorsis(y = y, x = x) head(res[[‚Äúix‚Äù]], n = 5) bcorsis result shows first third variable two important variables 3000 explanatory variables consistent simulation settings.","code":"In this example, the result is: ```{r} # [1]    3    1 1601   20  429"},{"path":"https://mamba413.github.io/Ball/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"use Ball reference vignettes presentation publication, appreciate citations package. > Zhu J, Pan W, Zheng W, Wang X (2021). ‚ÄúBall: R Package Detecting Distribution Difference Association Metric Spaces.‚Äù Journal Statistical Software, 97(6), 1‚Äì31. doi: 10.18637/jss.v097.i06. corresponding Bibtex entry","code":"@Article{,   title = {{Ball}: An {R} Package for Detecting Distribution Difference and Association in Metric Spaces},   author = {Jin Zhu and Wenliang Pan and Wei Zheng and Xueqin Wang},   journal = {Journal of Statistical Software},   year = {2021},   volume = {97},   number = {6},   pages = {1--31},   doi = {10.18637/jss.v097.i06}, }"},{"path":"https://mamba413.github.io/Ball/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"Pan, Wenliang; Tian, Yuan; Wang, Xueqin; Zhang, Heping. Ball Divergence: Nonparametric two sample test. Annals Statistics. 46 (2018), . 3, 1109‚Äì1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077 Wenliang Pan, Xueqin Wang, Weinan Xiao & Hongtu Zhu (2018) Generic Sure Independence Screening Procedure, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1462709 Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu & Jin Zhu (2019) Ball Covariance: Generic Measure Dependence Banach Space, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1543600 Jin Zhu, Wenliang Pan, Wei Zheng, Xueqin Wang (2021). Ball: R Package Detecting Distribution Difference Association Metric Spaces, Journal Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.","code":""},{"path":"https://mamba413.github.io/Ball/index.html","id":"bug-report","dir":"","previous_headings":"","what":"Bug report","title":"Statistical Inference and Sure Independence Screening via Ball Statistics","text":"find bugs, experience crashes, please report us. questions just ask, won‚Äôt bite. Open issue send email Jin Zhu zhuj37@mail2.sysu.edu.cn","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":null,"dir":"Reference","previous_headings":"","what":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"Sand, silt clay compositions 39 sediment samples different water depth Arctic lake.","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"ArcticLake$depth: water depth (meters). ArcticLake$x: compositions three covariates: sand, silt, clay.","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"Aitchison: CODA microcomputer statistical package, 1986, file name ARCTIC.DAT, included GNU Public Library Licence Version 2 newer.","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"Sand, silt clay compositions 39 sediment samples different water depth (meters) Arctic lake. additional feature concomitant variable covariate, water depth, may account variation compositions. statistical terminology, multivariate regression problem sediment composition predictors water depth response. row percentage sums 100, except rounding errors.","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"Courtesy J. Aitchison","code":""},{"path":"https://mamba413.github.io/Ball/reference/ArcticLake.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Arctic lake sediment samples of different water depth ‚Äî ArcticLake","text":"Aitchison: Statistical Analysis Compositional Data, 1986, Data 5, pp5.","code":""},{"path":"https://mamba413.github.io/Ball/reference/Ball-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics ‚Äî Ball-package","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics ‚Äî Ball-package","text":"Hypothesis tests sure independence screening (SIS) procedure based ball statistics, including ball divergence doi:10.1214/17-AOS1579 , ball covariance doi:10.1080/01621459.2018.1543600 , ball correlation doi:10.1080/01621459.2018.1462709 , permutation free procedure testing doi:10.1080/01621459.2023.2277417 , developed analyze complex data metric spaces, e.g, shape, directional, compositional symmetric positive definite matrix data. ball divergence ball covariance based distribution-free tests implemented detecting distribution difference association metric spaces doi:10.18637/jss.v097.i06 . Furthermore, several generic non-parametric feature selection procedures based ball correlation, BCor-SIS variants, implemented tackle challenge context ultra high dimensional data. fast implementation large-scale multiple K-sample testing ball divergence doi: 10.1002/gepi.22423  supported, particularly helpful genome-wide association study.","code":""},{"path":"https://mamba413.github.io/Ball/reference/Ball-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics ‚Äî Ball-package","text":"Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Annals Statistics. 46 (2018), . 3, 1109‚Äì1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077 Wenliang Pan, Xueqin Wang, Weinan Xiao & Hongtu Zhu (2018) Generic Sure Independence Screening Procedure, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1462709 Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu & Jin Zhu (2019) Ball Covariance: Generic Measure Dependence Banach Space, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1543600 Jin Zhu, Wenliang Pan, Wei Zheng, Xueqin Wang (2021). Ball: R Package Detecting Distribution Difference Association Metric Spaces, Journal Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06 Yue Hu, Haizhu Tan, Cai Li, Heping Zhang. (2021). Identifying genetic risk variants associated brain volumetric phenotypes via K-sample Ball Divergence method. Genetic Epidemiology, 1‚Äì11. https://doi.org/10.1002/gepi.22423","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/Ball-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ball: Statistical Inference and Sure Independence Screening via Ball Statistics ‚Äî Ball-package","text":"Xueqin Wang, Wenliang Pan, Heping Zhang, Hongtu Zhu, Yuan Tian, Weinan Xiao, Chengfeng Liu, Jin Zhu","code":""},{"path":"https://mamba413.github.io/Ball/reference/KBCovLimit.html","id":null,"dir":"Reference","previous_headings":"","what":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","title":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","text":"spectrum-based metric assocaition test (aka, Ball covariance test)","code":""},{"path":"https://mamba413.github.io/Ball/reference/KBCovLimit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","text":"","code":"KBCovLimit(x)"},{"path":"https://mamba413.github.io/Ball/reference/KBCovLimit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","text":"x list containing least two numeric distance matrices.","code":""},{"path":"https://mamba413.github.io/Ball/reference/KBCovLimit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","text":"KBCovLimit returns list containing following components: statistic Ball Covariance statistic. p.value p-value test.","code":""},{"path":"https://mamba413.github.io/Ball/reference/KBCovLimit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A spectrum-based metric assocaition test (aka, Ball covariance test) ‚Äî KBCovLimit","text":"","code":"library(Ball) set.seed(1) K <- 2 x <- list() Y <- list() n <- 200 for(i in 1:K){   Y[[i]] <- rnorm(n)   x[[i]] <- dist(Y[[i]]) } kbcov_res <- KBCovLimit(x)[c(\"statistics\", \"p.value\")] #> Error in KBCovLimit(x): object 'i' not found summary(kbcov_res) #> Error: object 'kbcov_res' not found bcov.test(Y[[1]],Y[[2]], method = \"limit\") #>  #> \tBall Covariance test of independence (Limit Distribution) #>  #> data:  Y[[1]] and Y[[2]] #> number of observations = 200 #> replicates = 0, weight: constant #> bcov.constant = 0.00017775, p-value = 0.174 #> alternative hypothesis: random variables are dependent #>   set.seed(1) x <- list() Y <- list() n <- 500 K <- 3 for(i in 1:K){   Y[[i]] <- rnorm(n)   x[[i]] <- dist(Y[[i]]) } kbcov_res <- KBCovLimit(x) #> Error in KBCovLimit(x): object 'i' not found kbcov_res[c(\"statistics\", \"p.value\")] #> Error: object 'kbcov_res' not found summary(kbcov_res[[\"eigenvalues\"]]) #> Error: object 'kbcov_res' not found"},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"Generic non-parametric sure independence screening (SIS) procedure based Ball Correlation. Ball correlation generic measure dependence Banach spaces.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"","code":"bcorsis(   x,   y,   d = \"small\",   weight = c(\"constant\", \"probability\", \"chisquare\"),   method = \"standard\",   distance = FALSE,   category = FALSE,   parms = list(d1 = 5, d2 = 5, df = 3),   num.threads = 0 )"},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"x numeric matrix data.frame included \\(n\\) rows \\(p\\) columns. row observation vector column corresponding explanatory variable, generally \\(p >> n\\). y numeric vector, matrix, data.frame. d hard cutoff rule suggests selecting \\(d\\) variables. Setting d = \"large\" d = \"small\" means n - 1 floor(n/log(n)) variables selected. d integer, d variables selected. Default: d = \"small\". weight logical character string used choose weight form Ball Covariance statistic.. input character string, must one \"constant\", \"probability\", \"chisquare\", \"rbf\". unambiguous substring can given. input logical value, equivalent weight = \"probability\" weight = TRUE equivalent weight = \"constant\" weight = FALSE. Default: weight = FALSE. method specific method BCor-SIS procedure. must one \"standard\", \"lm\", \"gam\", \"interaction\", \"survival\". Setting method = \"standard\" means performing standard SIS procedure options \"lm\" \"gam\" mean carrying iterative SIS procedure ordinary linear regression generalized additive models, respectively. options \"interaction\" \"survival\" designed detecting variables potential linear interaction associated left censored responses, respectively. unambiguous substring can given. Default: method = \"standard\". distance distance = TRUE, y considered distance matrix. Arguments available method = \"standard\" method = \"interaction\". Default: distance = FALSE. category logical value integer vector indicating columns selected categorical variables. category integer vector, positive/negative integers select/discard corresponding columns; category logical value, category = TRUE select columns, category = FALSE select none column. Default: category = FALSE. parms parameters list available method = \"lm\" \"gam\". contains three parameters: d1, d2, df. d1 number initially selected variables, d2 number variables added iteration. df degree freedom basis generalized additive models playing role method = \"gam\". Default: parms = list(d1 = 5, d2 = 5, df = 3). num.threads number threads. num.threads = 0, available cores used. Default num.threads = 0.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"ix indices vector corresponding variables selected BCor-SIS. method method used. weight weight used. complete.info list mainly containing \\(p \\times 3\\) matrix, row variable column weight Ball Correlation statistic. method = \"gam\" method = \"lm\", complete.info empty list.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"bcorsis performs model-free generic sure independence screening procedure, BCor-SIS, pick variables x potentially associated y. BCor-SIS relies Ball correlation, universal dependence measure Banach spaces. Ball correlation (BCor) ranges 0 1. larger BCor implies likely associated Bcor equal 0 implies unassociated. (See bcor details.) Consequently, BCor-SIS pick variables larger Bcor values y. Theory numerical result indicate BCor-SIS following advantages: BCor-SIS can retain efficient variables even dimensionality (.e., ncol(x)) exponential order sample size (.e., exp(nrow(x))); distribution-free model-free; robust; works well complex data, shape survival data; x matrix, sample sizes x y must agree. x list object, element list must sample size. x y must contain missing infinite values. method = \"survival\", matrix data.frame pass y must exactly two columns, first column event (failure) time second column dichotomous censored status.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"bcorsis simultaneously computing Ball Correlation statistics \"constant\", \"probability\", \"chisquare\" weights. Users can get Ball Correlation statistics different weight complete.info element output. give quick example illustrate.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"Wenliang Pan, Xueqin Wang, Weinan Xiao & Hongtu Zhu (2018) Generic Sure Independence Screening Procedure, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1462709","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"Wenliang Pan, Weinan Xiao, Xueqin Wang, Hongtu Zhu, Jin Zhu","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcorsis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ball Correlation based Sure Independence Screening (BCor-SIS) ‚Äî bcorsis","text":"","code":"if (FALSE) { # \\dontrun{  ############### Quick Start for bcorsis function ############### set.seed(1) n <- 150 p <- 3000 x <- matrix(rnorm(n * p), nrow = n) eps <- rnorm(n) y <- 3 * x[, 1] + 5 * (x[, 3])^2 + eps res <- bcorsis(y = y, x = x) head(res[[\"ix\"]]) head(res[[\"complete.info\"]][[\"statistic\"]])  ############### BCor-SIS: Censored Data Example ############### data(\"genlung\") result <- bcorsis(x = genlung[[\"covariate\"]], y = genlung[[\"survival\"]],                    method = \"survival\") index <- result[[\"ix\"]] top_gene <- colnames(genlung[[\"covariate\"]])[index] head(top_gene, n = 1)   ############### BCor-SIS: Interaction Pursuing ############### set.seed(1) n <- 150 p <- 3000 x <- matrix(rnorm(n * p), nrow = n) eps <- rnorm(n) y <- 3 * x[, 1] * x[, 5] * x[, 10] + eps res <- bcorsis(y = y, x = x, method = \"interaction\") head(res[[\"ix\"]])  ############### BCor-SIS: Iterative Method ############### library(mvtnorm) set.seed(1) n <- 150 p <- 3000 sigma_mat <- matrix(0.5, nrow = p, ncol = p) diag(sigma_mat) <- 1 x <- rmvnorm(n = n, sigma = sigma_mat) eps <- rnorm(n) rm(sigma_mat); gc(reset = TRUE) y <- 3 * (x[, 1])^2 + 5 * (x[, 2])^2 + 5 * x[, 8] - 8 * x[, 16] + eps res <- bcorsis(y = y, x = x, method = \"lm\", d = 15) res <- bcorsis(y = y, x = x, method = \"gam\", d = 15) res[[\"ix\"]]  ############### Weighted BCor-SIS: Probability weight ############### set.seed(1) n <- 150 p <- 3000 x <- matrix(rnorm(n * p), nrow = n) eps <- rnorm(n) y <- 3 * x[, 1] + 5 * (x[, 3])^2 + eps res <- bcorsis(y = y, x = x, weight = \"prob\") head(res[[\"ix\"]]) # Alternative, chisq weight: res <- bcorsis(y = y, x = x, weight = \"chisq\") head(res[[\"ix\"]])  ############### BCor-SIS: GWAS data ############### set.seed(1) n <- 150 p <- 3000 x <- sapply(1:p, function(i) {   sample(0:2, size = n, replace = TRUE) }) eps <- rnorm(n) y <- 6 * x[, 1] - 7 * x[, 2] + 5 * x[, 3] + eps res <- bcorsis(x = x, y = y, category = TRUE) head(res[[\"ix\"]]) head(res[[\"complete.info\"]][[\"statistic\"]])  x <- cbind(matrix(rnorm(n * 2), ncol = 2), x) # remove the first two columns: res <- bcorsis(x = x, y = y, category = c(-1, -2)) head(res[[\"ix\"]])  x <- cbind(x[, 3:5], matrix(rnorm(n * p), ncol = p)) res <- bcorsis(x = x, y = y, category = 1:3) head(res[[\"ix\"]], n = 10) } # }"},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball Covariance and Correlation Statistics ‚Äî bcor","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"Computes Ball Covariance Ball Correlation statistics, generic dependence measures Banach spaces.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"","code":"bcor(x, y, distance = FALSE, weight = FALSE)  bcov(x, y, distance = FALSE, weight = FALSE)"},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"x numeric vector, matrix, data.frame, list containing least two numeric vectors, matrices, data.frames. y numeric vector, matrix, data.frame. distance distance = TRUE, elements x y considered distance matrices. weight logical character string used choose weight form Ball Covariance statistic.. input character string, must one \"constant\", \"probability\", \"chisquare\", \"rbf\". unambiguous substring can given. input logical value, equivalent weight = \"probability\" weight = TRUE equivalent weight = \"constant\" weight = FALSE. Default: weight = FALSE.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"bcor Ball Correlation statistic. bcov Ball Covariance statistic.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"sample sizes two variables must agree,  samples must contain missing infinite values. set distance = TRUE, arguments x, y can dist object symmetric numeric matrix recording distance samples; otherwise, arguments treated data. bcov bcor compute Ball Covariance Ball Correlation statistics. Ball Covariance statistics generic dependence measure Banach spaces. enjoys following properties: nonnegative equal zero variables unassociated; highly robust; distribution-free model-free; interesting HHG special case Ball Covariance statistics. Ball correlation statistics, normalized version Ball Covariance statistics, generalizes Pearson correlation two fundamental ways: well-defined random variables arbitrary dimension Banach spaces BCor equal zero implies random variables unassociated. definitions Ball Covariance Ball Correlation statistics two random variables follows. Suppose, given pairs independent observations \\(\\{(x_1, y_1),...,(x_n,y_n)\\}\\), \\(x_i\\) \\(y_i\\) can dimension dimensionality \\(x_i\\) \\(y_i\\) need . , define sample version Ball Covariance : $$\\mathbf{BCov}_{\\omega, n}^{2}(X, Y)=\\frac{1}{n^{2}}\\sum_{,j=1}^{n}{(\\Delta_{ij,n}^{X,Y}-\\Delta_{ij,n}^{X}\\Delta_{ij,n}^{Y})^{2}} $$ : $$ \\Delta_{ij,n}^{X,Y}=\\frac{1}{n}\\sum_{k=1}^{n}{\\delta_{ij,k}^{X} \\delta_{ij,k}^{Y}}, \\Delta_{ij,n}^{X}=\\frac{1}{n}\\sum_{k=1}^{n}{\\delta_{ij,k}^{X}}, \\Delta_{ij,n}^{Y}=\\frac{1}{n}\\sum_{k=1}^{n}{\\delta_{ij,k}^{Y}} $$ $$\\delta_{ij,k}^{X} = (x_{k} \\\\bar{B}(x_{}, \\rho(x_{}, x_{j}))), \\delta_{ij,k}^{Y} = (y_{k} \\\\bar{B}(y_{}, \\rho(y_{}, y_{j})))$$ Among , \\(\\bar{B}(x_{}, \\rho(x_{}, x_{j}))\\) closed ball center \\(x_{}\\) radius \\(\\rho(x_{}, x_{j})\\). Similarly, can define \\( \\mathbf{BCov}_{\\omega,n}^2(\\mathbf{X},\\mathbf{X}) \\) \\( \\mathbf{BCov}_{\\omega,n}^2(\\mathbf{Y},\\mathbf{Y}) \\). define Ball Correlation statistic follows. $$\\mathbf{BCor}_{\\omega,n}^2(\\mathbf{X},\\mathbf{Y})= \\mathbf{BCov}_{\\omega,n}^2(\\mathbf{X},\\mathbf{Y})/\\sqrt{\\mathbf{BCov}_{\\omega,n}^2(\\mathbf{X},\\mathbf{X})\\mathbf{BCov}_{\\omega,n}^2(\\mathbf{Y},\\mathbf{Y})} $$ can extend \\(\\mathbf{BCov}_{\\omega,n}\\) measure mutual independence \\(K\\) random variables: $$\\frac{1}{n^{2}}\\sum_{,j=1}^{n}{\\left[ (\\Delta_{ij,n}^{X_{1}, ..., X_{K}}-\\prod_{k=1}^{K}\\Delta_{ij,n}^{X_{k}})^{2}\\prod_{k=1}^{K}{\\hat{\\omega}_{k}(X_{ki},X_{kj})} \\right]}$$ \\(X_{k}(k=1,\\ldots,K)\\) random variables \\(X_{ki}\\) \\(\\)-th observations \\(X_{k}\\). See bcov.test test independence based Ball Covariance statistic.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu & Jin Zhu (2019) Ball Covariance: Generic Measure Dependence Banach Space, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1543600 Wenliang Pan, Xueqin Wang, Weinan Xiao & Hongtu Zhu (2018) Generic Sure Independence Screening Procedure, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1462709 Jin Zhu, Wenliang Pan, Wei Zheng, Xueqin Wang (2021). Ball: R Package Detecting Distribution Difference Association Metric Spaces, Journal Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ball Covariance and Correlation Statistics ‚Äî bcor","text":"","code":"############# Ball Correlation ############# num <- 50 x <- 1:num y <- 1:num bcor(x, y) #> bcor.constant  #>             1  bcor(x, y, weight = \"prob\") #> bcor.probability  #>                1  bcor(x, y, weight = \"chisq\") #> bcor.chisquare  #>              1  ############# Ball Covariance ############# num <- 50 x <- rnorm(num) y <- rnorm(num) bcov(x, y) #> bcov.constant  #>  0.0006032344  bcov(x, y, weight = \"prob\") #> bcov.probability  #>       0.02840163  bcov(x, y, weight = \"chisq\") #> bcov.chisquare  #>     0.04729981"},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball Covariance Test ‚Äî bcov.test","title":"Ball Covariance Test ‚Äî bcov.test","text":"Ball Covariance test independence. Ball covariance generic dependence measures Banach spaces.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ball Covariance Test ‚Äî bcov.test","text":"","code":"bcov.test(x, ...)  # Default S3 method bcov.test(   x,   y = NULL,   num.permutations = 99,   method = c(\"permutation\", \"limit\"),   distance = FALSE,   weight = FALSE,   seed = 1,   num.threads = 0,   ... )  # S3 method for class 'formula' bcov.test(formula, data, subset, na.action, ...)"},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ball Covariance Test ‚Äî bcov.test","text":"x numeric vector, matrix, data.frame, list containing least two numeric vectors, matrices, data.frames. ... arguments passed methods. y numeric vector, matrix, data.frame. num.permutations number permutation replications. num.permutations = 0, function just returns Ball Covariance statistic. Default: num.permutations = 99. method method = \"permutation\", permutation procedure carried compute \\(p\\)-value;  method = \"limit\", approximate null distribution used weight = \"constant\". unambiguous substring can given. Default method = \"permutation\". distance distance = TRUE, elements x y considered distance matrices. weight logical character string used choose weight form Ball Covariance statistic.. input character string, must one \"constant\", \"probability\", \"chisquare\", \"rbf\". unambiguous substring can given. input logical value, equivalent weight = \"probability\" weight = TRUE equivalent weight = \"constant\" weight = FALSE. Default: weight = FALSE. seed random seed. Default seed = 1. num.threads number threads. num.threads = 0, available cores used. Default num.threads = 0. formula formula form ~ u + v, u v numeric variables giving data values one sample. samples must length. data optional matrix data frame (similar: see model.frame) containing variables formula formula. default variables taken environment(formula). subset optional vector specifying subset observations used. na.action function indicates happen data contain NAs. Defaults getOption(\"na.action\").","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ball Covariance Test ‚Äî bcov.test","text":"num.permutations > 0, bcov.test returns htest class object containing following components: statistic Ball Covariance statistic. p.value p-value test. replicates permutation replications test statistic. size sample size. complete.info list mainly containing two vectors, first vector Ball Covariance statistics different weights, second \\(p\\)-values weighted Ball Covariance tests. alternative character string describing alternative hypothesis. method character string indicating type test performed. data.name description data. num.permutations = 0, bcov.test returns statistic value.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ball Covariance Test ‚Äî bcov.test","text":"bcov.test non-parametric tests independence Banach spaces. can detect dependence two random objects (variables) mutual dependence among least three random objects (variables). two samples pass arguments x y, sample sizes (.e. number rows length vector) two variables must agree. list object passed x, list must contain least two numeric vectors, matrices, data.frames, element list must sample size. Moreover, data pass x y must contain missing infinite values. distance = TRUE, x considered distance matrix list containing distance matrices, y considered distance matrix; otherwise, arguments treated data. bcov.test utilizes Ball Covariance statistics (see bcov) measure dependence derives \\(p\\)-value via replicating random permutation num.permutations times. See Pan et al 2018 theoretical properties test, including statistical consistency.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Ball Covariance Test ‚Äî bcov.test","text":"Actually, bcov.test simultaneously computing Ball Covariance statistics \"constant\", \"probability\", \"chisquare\", \"rbf\" weights. Users can get Ball Covariance statistics different weight corresponding \\(p\\)-values complete.info element output. give quick example illustrate.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball Covariance Test ‚Äî bcov.test","text":"Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu & Jin Zhu (2019) Ball Covariance: Generic Measure Dependence Banach Space, Journal American Statistical Association, DOI: 10.1080/01621459.2018.1543600 Jin Zhu, Wenliang Pan, Wei Zheng, Xueqin Wang (2021). Ball: R Package Detecting Distribution Difference Association Metric Spaces, Journal Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ball Covariance Test ‚Äî bcov.test","text":"Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu, Jin Zhu","code":""},{"path":"https://mamba413.github.io/Ball/reference/bcov.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ball Covariance Test ‚Äî bcov.test","text":"","code":"set.seed(1)  ################# Quick Start ################# noise <- runif(50, min = -0.3, max = 0.3) x <- runif(50, 0, 4*pi) y <- cos(x) + noise # plot(x, y) res <- bcov.test(x, y) res #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  x and y #> number of observations = 50 #> replicates = 99, weight: constant #> bcov.constant = 0.0021965, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>  ## get all Ball Covariance statistics: res[[\"complete.info\"]][[\"statistic\"]] #>    bcov.constant bcov.probability   bcov.chisquare         bcov.rbf  #>      0.002196459      0.052685015      0.102469543      0.000000000  ## get all test result: res[[\"complete.info\"]][[\"p.value\"]] #>    bcov.constant.pvalue bcov.probability.pvalue   bcov.chisquare.pvalue  #>                    0.01                    0.01                    0.01  #>         bcov.rbf.pvalue  #>                    1.00   ################# Quick Start ################# x <- matrix(runif(50 * 2, -pi, pi), nrow = 50, ncol = 2) noise <- runif(50, min = -0.1, max = 0.1) y <- sin(x[,1] + x[,2]) + noise bcov.test(x = x, y = y, weight = \"prob\") #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  x and y #> number of observations = 50 #> replicates = 99, weight: probability #> bcov.probability = 0.037445, p-value = 0.06 #> alternative hypothesis: random variables are dependent #>   ################# Ball Covariance Test for Non-Hilbert Data ################# # load data: data(\"ArcticLake\") # Distance matrix between y: Dy <- nhdist(ArcticLake[[\"x\"]], method = \"compositional\") # Distance matrix between x: Dx <- dist(ArcticLake[[\"depth\"]]) # hypothesis test with BCov: bcov.test(x = Dx, y = Dy, distance = TRUE) #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  Dx and Dy #> number of observations = 39 #> replicates = 99, weight: constant #> bcov.constant = 0.0083848, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>   ################  Weighted Ball Covariance Test  ################# data(\"ArcticLake\") Dy <- nhdist(ArcticLake[[\"x\"]], method = \"compositional\") Dx <- dist(ArcticLake[[\"depth\"]]) # hypothesis test with weighted BCov: bcov.test(x = Dx, y = Dy, distance = TRUE, weight = \"prob\") #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  Dx and Dy #> number of observations = 39 #> replicates = 99, weight: probability #> bcov.probability = 0.088597, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>   ################# Mutual Independence Test ################# x <- rnorm(50) y <- (x > 0) * x + rnorm(50) z <- (x <= 0) * x + rnorm(50) data_list <- list(x, y, z) bcov.test(data_list) #>  #> \tBall Covariance test of mutual independence (Permutation) #>  #> data:  data_list #> number of observations = 50 #> replicates = 99, weight: constant #> bcov.constant = 0.0015441, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>  data_list <- lapply(data_list, function(x) {   as.matrix(dist(x)) }) bcov.test(data_list, distance = TRUE) #>  #> \tBall Covariance test of mutual independence (Permutation) #>  #> data:  data_list #> number of observations = 50 #> replicates = 99, weight: constant #> bcov.constant = 0.0015441, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>  bcov.test(data_list, distance = FALSE, weight = \"chi\") #>  #> \tBall Covariance test of mutual independence (Permutation) #>  #> data:  data_list #> number of observations = 50 #> replicates = 99, weight: chisquare #> bcov.chisquare = 1.7534, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>   ################# Mutual Independence Test for Meteorology data ################# data(\"meteorology\") bcov.test(meteorology) #>  #> \tBall Covariance test of mutual independence (Permutation) #>  #> data:  meteorology #> number of observations = 46 #> replicates = 99, weight: constant #> bcov.constant = 0.0064547, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>   ################  Testing via approximate limit distribution  ################# if (FALSE) { # \\dontrun{ set.seed(1) n <- 2000 x <- rnorm(n) y <- rnorm(n) bcov.test(x, y, method = \"limit\") bcov.test(x, y) } # }  ################  Formula interface  ################ ## independence test: bcov.test(~ CONT + INTG, data = USJudgeRatings) #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  CONT and INTG #> number of observations = 43 #> replicates = 99, weight: constant #> bcov.constant = 0.00079459, p-value = 0.39 #> alternative hypothesis: random variables are dependent #>  ## independence test with chisquare weight: bcov.test(~ CONT + INTG, data = USJudgeRatings, weight = \"chi\") #>  #> \tBall Covariance test of independence (Permutation) #>  #> data:  CONT and INTG #> number of observations = 43 #> replicates = 99, weight: chisquare #> bcov.chisquare = 0.038503, p-value = 0.39 #> alternative hypothesis: random variables are dependent #>  ## mutual independence test: bcov.test(~ CONT + INTG + DMNR, data = USJudgeRatings) #>  #> \tBall Covariance test of mutual independence (Permutation) #>  #> data:  CONT and INTG and DMNR #> number of observations = 43 #> replicates = 99, weight: constant #> bcov.constant = 0.0078353, p-value = 0.01 #> alternative hypothesis: random variables are dependent #>"},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"Fast K-sample Ball Divergence Test GWAS Data","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"","code":"bd.gwas.test(   x,   snp,   screening.method = c(\"permute\", \"spectrum\"),   refine = TRUE,   num.permutations,   distance = FALSE,   alpha,   screening.result = NULL,   verbose = TRUE,   seed = 1,   num.threads = 0,   ... )"},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"x numeric vector, matrix, data.frame, dist object. snp numeric matrix recording values single nucleotide polymorphism (SNP). column must integer vector. screening.method screening.method = \"spectrum\", spectrum method applied screening candidate SNPs, otherwise, permutation method applied. Default: screening.method = \"permute\". refine logical value. refine = TRUE, \\(p\\)-values refining process applied SNPs passes pre-screening process. Default: refine = TRUE (present, refine = FALSE available). num.permutations number permutation replications. num.permutations = 0, function just returns Ball Divergence statistic. Default: num.permutations = 100 * ncol(snp) distance distance = TRUE, elements x considered distance matrix. Default: distance = FALSE. alpha significance level. Default: 0.05 / ncol(snp). screening.result object return bd.gwas.test preserving pre-screening result. works pre-screening available. Default: screening.result = NULL. verbose Show computation status estimated runtimes. Default: verbose = FALSE. seed random seed. Default seed = 1. num.threads number threads. num.threads = 0, available cores used. Default num.threads = 0. ... arguments passed methods.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"bd.gwas.test returns list containing following components: statistic ball divergence statistics vector. permuted.statistic data.frame containing permuted ball divergence statistic pre-screening SNPs. refine = FALSE, takes value NULL. eigenvalue eigenvalue spectrum decomposition. refine = TRUE, takes value NULL. p.value p-values ball divergence test. refined.snp SNPs refined. refined.p.value refined \\(p\\)-value significant snp. refined.permuted.statistic data.frame containing permuted ball divergence statistics refining \\(p\\)-values. screening.result list containing result screening.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"Yue Hu, Haizhu Tan, Cai Li, Heping Zhang. (2021). Identifying genetic risk variants associated brain volumetric phenotypes via K-sample Ball Divergence method. Genetic Epidemiology, 1‚Äì11. https://doi.org/10.1002/gepi.22423","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"Jin Zhu","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.gwas.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fast K-sample Ball Divergence Test for GWAS Data ‚Äî bd.gwas.test","text":"","code":"# \\donttest{ library(Ball) set.seed(1234) num <- 200 snp_num <- 500 p <- 5 x <- matrix(rnorm(num * p), nrow = num) snp <- sapply(1:snp_num, function(i) {   sample(0:2, size = num, replace = TRUE) }) snp1 <- sapply(1:snp_num, function(i) {   sample(1:2, size = num, replace = TRUE) }) snp <- cbind(snp, snp1) res <- Ball::bd.gwas.test(x = x, snp = snp) #> =========== Pre-screening SNPs =========== #> [1] \"None of SNP pass the pre-screening process!\" mean(res[[\"p.value\"]] < 0.05) #> [1] 0.039 mean(res[[\"p.value\"]] < 0.005) #> [1] 0.005  ## only return the test statistics; res <- Ball::bd.gwas.test(x = x, snp = snp, num.permutation = 0)  ## save pre-screening process results: x <- matrix(rnorm(num * p), nrow = num) snp <- sapply(1:snp_num, function(i) {   sample(0:2, size = num, replace = TRUE, prob = c(1/2, 1/4, 1/4)) }) snp_screening <- Ball::bd.gwas.test(x = x, snp = snp,                                     alpha = 5*10^-4,                                      num.permutations = 19999) #> =========== Pre-screening SNPs =========== #> [1] \"None of SNP pass the pre-screening process!\" mean(res[[\"p.value\"]] < 0.05) #> [1] 0 mean(res[[\"p.value\"]] < 0.005) #> [1] 0 mean(res[[\"p.value\"]] < 0.0005) #> [1] 0 ## refine p-value according to the pre-screening process result: res <- Ball::bd.gwas.test(x = x, snp = snp, alpha = 5*10^-4,                           num.permutations = 19999,                           screening.result = snp_screening[[\"screening.result\"]]) # }"},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball Divergence statistic ‚Äî bd","title":"Ball Divergence statistic ‚Äî bd","text":"Compute Ball Divergence statistic, generic dispersion measure Banach spaces.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ball Divergence statistic ‚Äî bd","text":"","code":"bd(   x,   y = NULL,   distance = FALSE,   size = NULL,   num.threads = 1,   kbd.type = c(\"sum\", \"maxsum\", \"max\") )"},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ball Divergence statistic ‚Äî bd","text":"x numeric vector, matrix, data.frame, list containing least two numeric vectors, matrices, data.frames. y numeric vector, matrix, data.frame. distance distance = TRUE, elements x considered distance matrix. Default: distance = FALSE. size vector recording sample size group. num.threads number threads. num.threads = 0, available cores used. Default num.threads = 0. kbd.type character string specifying \\(K\\)-sample Ball Divergence test statistic, must one \"sum\", \"summax\", \"max\". unambiguous substring can given. Default kbd.type = \"sum\".","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ball Divergence statistic ‚Äî bd","text":"bd Ball Divergence statistic","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ball Divergence statistic ‚Äî bd","text":"Given samples containing missing values, bd returns Ball Divergence statistics. set distance = TRUE, arguments x, y can dist object symmetric numeric matrix recording distance samples; otherwise, arguments treated data. Ball divergence statistic measure distribution difference two datasets Banach spaces. Ball divergence statistic proven zero two datasets identical. definition Ball Divergence statistics follows. Given two independent samples \\( \\{x_{1}, \\ldots, x_{n}\\} \\) associated probability measure \\(\\mu\\) \\( \\{y_{1}, \\ldots, y_{m}\\} \\) \\(\\nu\\), observations sample ..d. Let \\(\\delta(x,y,z)=(z\\\\bar{B}(x, \\rho(x,y)))\\), \\(\\delta(x,y,z)\\) indicates whether \\(z\\) located closed ball \\(\\bar{B}(x, \\rho(x,y))\\) center \\(x\\) radius \\(\\rho(x, y)\\). denote: $$ A_{ij}^{X}=\\frac{1}{n}\\sum_{u=1}^{n}{\\delta(X_i,X_j,X_u)}, \\quad A_{ij}^{Y}=\\frac{1}{m}\\sum_{v=1}^{m}{\\delta(X_i,X_j,Y_v)}, $$ $$ C_{kl}^{X}=\\frac{1}{n}\\sum_{u=1}^{n}{\\delta(Y_k,Y_l,X_u)}, \\quad C_{kl}^{Y}=\\frac{1}{m}\\sum_{v=1}^{m}{\\delta(Y_k,Y_l,Y_v)}. $$ \\(A_{ij}^X\\) represents proportion samples \\( \\{x_{1}, \\ldots, x_{n}\\} \\) located ball \\(\\bar{B}(X_i,\\rho(X_i,X_j))\\) \\(A_{ij}^Y\\) represents proportion samples \\( \\{y_{1}, \\ldots, y_{m}\\} \\) located ball \\(\\bar{B}(X_i,\\rho(X_i,X_j))\\). Meanwhile, \\(C_{kl}^X\\) \\(C_{kl}^Y\\) represent corresponding proportions located ball \\(\\bar{B}(Y_k,\\rho(Y_k,Y_l))\\). Ball Divergence statistic defined : $$D_{n,m}=A_{n,m}+C_{n,m}$$ Ball Divergence can generalized K-sample test problem. Suppose \\(K\\) group samples, group include \\(n_{k}\\) samples. definition \\(K\\)-sample Ball Divergence statistic directly sum two-sample Ball Divergence statistics sample pairs (kbd.type = \"sum\") $$\\sum_{1 \\leq k < l \\leq K}{D_{n_{k},n_{l}}},$$ find one sample largest difference others (kbd.type = \"maxsum\") $$\\max_{t}{\\sum_{s=1, s \\neq t}^{K}{D_{n_{s}, n_{t}}},}$$ aggregate \\(K-1\\) significant different two-sample Ball Divergence statistics (kbd.type = \"max\") $$\\sum_{k=1}^{K-1}{D_{(k)}},$$ \\(D_{(1)}, \\ldots, D_{(K-1)}\\) largest \\(K-1\\) two-sample Ball Divergence statistics among \\(\\{D_{n_s, n_t}| 1 \\leq s < t \\leq K\\}\\). \\(K=2\\), three types Ball Divergence statistics degenerate two-sample Ball Divergence statistic. See bd.test test distribution equality based Ball Divergence.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball Divergence statistic ‚Äî bd","text":"Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Ann. Statist. 46 (2018), . 3, 1109‚Äì1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ball Divergence statistic ‚Äî bd","text":"Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ball Divergence statistic ‚Äî bd","text":"","code":"############# Ball Divergence ############# x <- rnorm(50) y <- rnorm(50) bd(x, y) #> bd.constant  #>  0.00795312"},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"Performs nonparametric two-sample \\(K\\)-sample Ball Divergence test equality multivariate distributions","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"","code":"bd.test(x, ...)  # Default S3 method bd.test(   x,   y = NULL,   num.permutations = 99,   method = c(\"permutation\", \"limit\"),   distance = FALSE,   size = NULL,   seed = 1,   num.threads = 0,   kbd.type = c(\"sum\", \"maxsum\", \"max\"),   weight = c(\"constant\", \"variance\", \"rbf\"),   ... )  # S3 method for class 'formula' bd.test(formula, data, subset, na.action, ...)"},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"x numeric vector, matrix, data.frame, list containing least two numeric vectors, matrices, data.frames. ... arguments passed methods. y numeric vector, matrix, data.frame. num.permutations number permutation replications. num.permutations = 0, function just returns Ball Divergence statistic. Default: num.permutations = 99. method method = \"permutation\", permutation procedure carried compute \\(p\\)-value;  method = \"limit\", approximate null distribution used weight = \"constant\". unambiguous substring can given. Default method = \"permutation\". distance distance = TRUE, elements x considered distance matrix. Default: distance = FALSE. size vector recording sample size group. seed random seed. Default seed = 1. num.threads number threads. num.threads = 0, available cores used. Default num.threads = 0. kbd.type character string specifying \\(K\\)-sample Ball Divergence test statistic, must one \"sum\", \"summax\", \"max\". unambiguous substring can given. Default kbd.type = \"sum\". weight character string specifying weight form Ball Divergence statistic. must one \"constant\" \"variance\". unambiguous substring can given. Default: weight = \"constant\". formula formula form response ~ group response gives data values group vector factor corresponding groups. data optional matrix data frame (similar: see model.frame) containing variables formula formula. default variables taken environment(formula). subset optional vector specifying subset observations used. na.action function indicates happen data contain NAs. Defaults getOption(\"na.action\").","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"num.permutations > 0, bd.test returns htest class object containing following components: statistic Ball Divergence statistic. p.value \\(p\\)-value test. replicates permutation replications test statistic. size sample sizes. complete.info list mainly containing two vectors, first vector Ball Divergence statistics different aggregation strategy weight, second vector \\(p\\)-values tests. alternative character string describing alternative hypothesis. method character string indicating type test performed. data.name description data. num.permutations = 0, bd.test returns statistic value.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"bd.test nonparametric test two-sample \\(K\\)-sample problem. can detect distribution difference \\(K(K \\geq 2)\\) sample even though sample size imbalanced. test can cope well multivariate dataset complex dataset. x given, statistic computed original pooled samples, stacked matrix row multivariate observation, distance matrix distance = TRUE. first sizes[1] rows x first sample, next sizes[2] rows x second sample, etc. x list, elements taken samples compared, hence, list must contain least two numeric data vectors, matrices data.frames. bd.test utilizes Ball Divergence statistics (see bd) measure dispersion derives \\(p\\)-value via replicating random permutation num.permutations times. function simply returns test statistic num.permutations = 0. time complexity bd.test around \\(O(R \\times n^2)\\), \\(R\\) = num.permutations \\(n\\) sample size.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"Actually, bd.test simultaneously computing \"sum\", \"summax\", \"max\" Ball Divergence statistics \\(K \\geq 3\\). Users can get Ball Divergence statistics corresponding \\(p\\)-values complete.info element output. give quick example illustrate.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Annals Statistics. 46 (2018), . 3, 1109‚Äì1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077 Jin Zhu, Wenliang Pan, Wei Zheng, Xueqin Wang (2021). Ball: R Package Detecting Distribution Difference Association Metric Spaces, Journal Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.","code":""},{"path":[]},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang, Jin Zhu","code":""},{"path":"https://mamba413.github.io/Ball/reference/bd.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ball Divergence based Equality of Distributions Test ‚Äî bd.test","text":"","code":"################# Quick Start ################# set.seed(1) x <- rnorm(50) y <- rnorm(50, mean = 1) # plot(density(x)) # lines(density(y), col = \"red\") bd.test(x = x, y = y) #>  #> \t2-sample Ball Divergence Test (Permutation) #>  #> data:  x and y  #> number of observations = 100, group sizes: 50 50 #> replicates = 99, weight: constant #> bd.constant = 0.092215, p-value = 0.01 #> alternative hypothesis: distributions of samples are distinct #>   ################# Quick Start ################# x <- matrix(rnorm(100), nrow = 50, ncol = 2) y <- matrix(rnorm(100, mean = 3), nrow = 50, ncol = 2) # Hypothesis test with Standard Ball Divergence: bd.test(x = x, y = y) #>  #> \t2-sample Ball Divergence Test (Permutation) #>  #> data:  x and y  #> number of observations = 100, group sizes: 50 50 #> replicates = 99, weight: constant #> bd.constant = 0.5505, p-value = 0.01 #> alternative hypothesis: distributions of samples are distinct #>   ################# Simlated Non-Hilbert data ################# data(\"bdvmf\") if (FALSE) { # \\dontrun{ library(scatterplot3d) scatterplot3d(bdvmf[[\"x\"]], color = bdvmf[[\"group\"]],                xlab = \"X1\", ylab = \"X2\", zlab = \"X3\") } # } # calculate geodesic distance between sample: Dmat <- nhdist(bdvmf[[\"x\"]], method = \"geodesic\") # hypothesis test with BD : bd.test(x = Dmat, size = c(150, 150), num.permutations = 99, distance = TRUE) #>  #> \t2-sample Ball Divergence Test (Permutation) #>  #> data:  Dmat  #> number of observations = 300, group sizes: 150 150 #> replicates = 99, weight: constant #> bd.constant = 0.14483, p-value = 0.01 #> alternative hypothesis: distributions of samples are distinct #>   ################# Non-Hilbert Real Data ################# # load data: data(\"macaques\") # number of femala and male Macaca fascicularis: table(macaques[[\"group\"]]) #>  #> f m  #> 9 9  # calculate Riemannian shape distance matrix: Dmat <- nhdist(macaques[[\"x\"]], method = \"riemann\") # hypothesis test with BD: bd.test(x = Dmat, num.permutations = 99, size = c(9, 9), distance = TRUE) #>  #> \t2-sample Ball Divergence Test (Permutation) #>  #> data:  Dmat  #> number of observations = 18, group sizes: 9 9 #> replicates = 99, weight: constant #> bd.constant = 0.1922, p-value = 0.03 #> alternative hypothesis: distributions of samples are distinct #>   ################  K-sample Test  ################# n <- 150 bd.test(rnorm(n), size = c(40, 50, 60)) #>  #> \t3-sample Ball Divergence Test (Permutation) #>  #> data:  rnorm(n)  #> number of observations = 150, group sizes: 40 50 60 #> replicates = 99, weight: constant, kbd.type: sum #> kbd.sum.constant = 0.063678, p-value = 0.21 #> alternative hypothesis: distributions of samples are distinct #>  # alternative input method: x <- lapply(c(40, 50, 60), rnorm) res <- bd.test(x) res #>  #> \t3-sample Ball Divergence Test (Permutation) #>  #> data:  x  #> number of observations = 150, group sizes: 40 50 60 #> replicates = 99, weight: constant, kbd.type: sum #> kbd.sum.constant = 0.031662, p-value = 0.74 #> alternative hypothesis: distributions of samples are distinct #>  ## get all Ball Divergence statistics: res[[\"complete.info\"]][[\"statistic\"]] #>    kbd.sum.constant    kbd.sum.variance    kbd.max.constant    kbd.max.variance  #>          0.03166189          0.03166189          0.02488730          0.02488730  #> kbd.maxsum.constant kbd.maxsum.variance  #>          0.02488730          0.02488730  ## get all test result: res[[\"complete.info\"]][[\"p.value\"]] #>    kbd.sum.constant.pvalue    kbd.sum.variance.pvalue  #>                       0.74                       0.74  #>    kbd.max.constant.pvalue    kbd.max.variance.pvalue  #>                       0.76                       0.76  #> kbd.maxsum.constant.pvalue kbd.maxsum.variance.pvalue  #>                       0.76                       0.76   ################  Testing via approximate limit distribution  ################# if (FALSE) { # \\dontrun{ set.seed(1) n <- 1000 x <- rnorm(n) y <- rnorm(n) res <- bd.test(x, y, method = \"limit\") bd.test(x, y) } # }  ################  Formula interface  ################ ## Two-sample test bd.test(extra ~ group, data = sleep) #>  #> \t2-sample Ball Divergence Test (Permutation) #>  #> data:  extra by group #> number of observations = 20, group sizes: 10 10 #> replicates = 99, weight: constant #> bd.constant = 0.0895, p-value = 0.32 #> alternative hypothesis: distributions of samples are distinct #>  ## K-sample test bd.test(Sepal.Width ~ Species, data = iris) #>  #> \t3-sample Ball Divergence Test (Permutation) #>  #> data:  Sepal.Width by Species #> number of observations = 150, group sizes: 50 50 50 #> replicates = 99, weight: constant, kbd.type: sum #> kbd.sum.constant = 0.48817, p-value = 0.01 #> alternative hypothesis: distributions of samples are distinct #>  bd.test(Sepal.Width ~ Species, data = iris, kbd.type = \"max\") #>  #> \t3-sample Ball Divergence Test (Permutation) #>  #> data:  Sepal.Width by Species #> number of observations = 150, group sizes: 50 50 50 #> replicates = 99, weight: constant, kbd.type: max #> kbd.max.constant = 0.4618, p-value = 0.01 #> alternative hypothesis: distributions of samples are distinct #>"},{"path":"https://mamba413.github.io/Ball/reference/bdvmf.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated von Mises-Fisher Data ‚Äî bdvmf","title":"Simulated von Mises-Fisher Data ‚Äî bdvmf","text":"Simulated random vectors following von Mises-Fisher distribution mean direction \\(\\mu_{x}=(1, 0, 0)\\) \\(\\mu_{y}=(1, 1, 1)\\), concentration parameter \\(\\kappa = 3\\).","code":""},{"path":"https://mamba413.github.io/Ball/reference/bdvmf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated von Mises-Fisher Data ‚Äî bdvmf","text":"bdvmf$x: \\(300 \\times 3\\) numeric matrix containing simulated von Mises-Fisher data. bdvmf$group: group index vector.","code":""},{"path":"https://mamba413.github.io/Ball/reference/bdvmf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulated von Mises-Fisher Data ‚Äî bdvmf","text":"directional statistics, von Mises‚ÄìFisher distribution (named Ronald Fisher Richard von Mises), probability distribution \\((p-1)\\)-dimensional sphere \\(R^{p}\\) parameters \\(\\mu\\), \\(\\kappa\\), called mean direction concentration parameter, respectively. greater value \\(\\kappa\\), higher concentration distribution around mean direction \\(\\mu\\),. distribution unimodal \\(\\kappa\\), uniform sphere \\(\\kappa=0\\).","code":""},{"path":"https://mamba413.github.io/Ball/reference/bdvmf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulated von Mises-Fisher Data ‚Äî bdvmf","text":"Embleton, N. . Fisher, T. Lewis, B. J. J. (1993). Statistical analysis spherical data (1st pbk. ed.). Cambridge: Cambridge University Press. pp. 115‚Äì116. ISBN 0-521-45699-1.","code":""},{"path":"https://mamba413.github.io/Ball/reference/genlung.html","id":null,"dir":"Reference","previous_headings":"","what":"Lung cancer genomic data ‚Äî genlung","title":"Lung cancer genomic data ‚Äî genlung","text":"Publicly available lung cancer genomic data Chemores Cohort Study, containing expression levels mRNA, miRNA, artificial noise variables well clinical variables response.","code":""},{"path":"https://mamba413.github.io/Ball/reference/genlung.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Lung cancer genomic data ‚Äî genlung","text":"genlung$survival: data.frame containing \\(n=123\\) complete observations. first column disease-free survival time second column censoring status. genlung$covariate: data.frame containing \\(p=2000\\) covariates.","code":""},{"path":"https://mamba413.github.io/Ball/reference/genlung.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lung cancer genomic data ‚Äî genlung","text":"Tissue samples analysed cohort 123 patients, underwent complete surgical resection Institut Mutualiste Montsouris (Paris, France) 30 January 2002 26 June 2006. studied outcome \"Disease-Free Survival Time\". Patients followed first relapse occurred administrative censoring. genomic dataset, expression levels Agilent miRNA probes (\\(p=939\\)) included \\(n=123\\) cohort samples. miRNA data contains normalized expression levels. See paper Lazar et al. (2013) Array Express data repository complete description samples, tissue preparation, Agilent array technology, data normalization. addition genomic data, five clinical variables, also evaluated cohort samples, included continuous variable ('Age') nominal variables ('Type','KRAS.status','EGFR.status','P53.status'). See Lazar et al. (2013) details. Moreover, add 1056 standard gaussian variables independent censored response noise covariates. dataset represents situation number covariates dominates number complete observations \\(p >> n\\) case.","code":""},{"path":"https://mamba413.github.io/Ball/reference/genlung.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Lung cancer genomic data ‚Äî genlung","text":"Lazar V. et al. (2013). Integrated molecular portrait non-small cell lung cancers. BMC Medical Genomics 6:53-65.","code":""},{"path":"https://mamba413.github.io/Ball/reference/macaques.html","id":null,"dir":"Reference","previous_headings":"","what":"Male and Female macaque data ‚Äî macaques","title":"Male and Female macaque data ‚Äî macaques","text":"Male female macaque skull data. 7 landmarks 3 dimensions, 18 individuals (9 males, 9 females)","code":""},{"path":"https://mamba413.github.io/Ball/reference/macaques.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Male and Female macaque data ‚Äî macaques","text":"macaques$x: array dimension \\(7 \\times 3 \\times 18\\) macaques$group: factor indicating sex ('m' male 'f' female)","code":""},{"path":"https://mamba413.github.io/Ball/reference/macaques.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Male and Female macaque data ‚Äî macaques","text":"investigation sex differences crania species Macaca fascicularis (type monkey), random samples 9 male 9 female skulls obtained Paul O‚ÄôHiggins (Hull-York Medical School) (Dryden Mardia 1993). subset seven anatomical landmarks located cranium three-dimensional (3D) coordinates point recorded.","code":""},{"path":"https://mamba413.github.io/Ball/reference/macaques.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Male and Female macaque data ‚Äî macaques","text":"Dryden, .L. Mardia, K.V. (1998). Statistical Shape Analysis, Wiley, Chichester.","code":""},{"path":"https://mamba413.github.io/Ball/reference/macaques.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Male and Female macaque data ‚Äî macaques","text":"Dryden, . L. Mardia, K. V. (1993). Multivariate shape analysis. Sankhya Series , 55, 460-480.","code":""},{"path":"https://mamba413.github.io/Ball/reference/meteorology.html","id":null,"dir":"Reference","previous_headings":"","what":"meteorological data ‚Äî meteorology","title":"meteorological data ‚Äî meteorology","text":"meteorological data include 46 records air, soil, humidity, wind evaporation.","code":""},{"path":"https://mamba413.github.io/Ball/reference/meteorology.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"meteorological data ‚Äî meteorology","text":"meteorology$air: data.frame containing 3 variables: maximum, minimum average daily air temperature meteorology$soil: data.frame containing 3 covariates: maximum, minimum average daily soil temperature meteorology$humidity: data.frame containing 3 covariates: maximum, minimum average daily humidity temperature, meteorology$wind: vector object record total wind, measured miles per day meteorology$evaporation: vector object record evaporation","code":""},{"path":"https://mamba413.github.io/Ball/reference/meteorology.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"meteorological data ‚Äî meteorology","text":"meteorological data containing 46 observations five groups variables: air temperature, soil temperature, relative humidity, wind speed well evaporation. Among , maximum, minimum average value air temperature, soil temperature, relative humidity recorded. regards wind speed evaporation, univariate numerical variables. desire test independence five groups variables.","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"function computes returns numeric distance matrix computed using specified distance measure compute distances rows data matrix.","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"","code":"nhdist(x, method = \"geodesic\")"},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"x numeric matrix, data frame numeric array dimension \\(k \\times m \\times n\\) containing \\(n\\) samples \\(k \\times m\\) dimension. method distance measure used. must one \"geodesic\", \"compositional\", \"riemann\". unambiguous substring can given.","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"\\(n \\times n\\) numeric distance matrix","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"Available distance measures geodesic, compositional riemann. Denoting two sample dataset \\(x\\) \\(y\\), give definition distance measures follows. geodesic: shortest route two points Earth's surface, namely, segment great circle. $$\\arccos(x^{T}y), \\|x\\|_{2} = \\|y\\|_{2} = 1$$ compositional: First, apply scale transformation , .e., \\((x_{i1}/t, ..., x_{ip}/t_{}), t_{} = \\sum_{d=1}^{p}{x_{d}}\\) . , apply square root transformation data calculate geodesic distance samples. riemann: \\(k \\times m \\times n\\) array \\(k\\) = number landmarks, \\(m\\) = number dimensions \\(n\\) = sample size. Detail riemannian shape distance given Kendall, D. G. (1984).","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"Kendall, D. G. (1984). Shape manifolds, Procrustean metrics complex projective spaces, Bulletin London Mathematical Society, 16, 81-121.","code":""},{"path":"https://mamba413.github.io/Ball/reference/nhdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance Matrix Computation for Non-Hilbert Data ‚Äî nhdist","text":"","code":"data('bdvmf') Dmat <- nhdist(bdvmf[['x']], method = \"geodesic\")  data(\"ArcticLake\") Dmat <- nhdist(ArcticLake[['x']], method = \"compositional\")  data(\"macaques\") Dmat <- nhdist(macaques[[\"x\"]], method = \"riemann\")  # unambiguous substring also available: Dmat <- nhdist(macaques[[\"x\"]], method = \"rie\")"},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-1312","dir":"Changelog","previous_headings":"","what":"Ball 1.3.12","title":"Ball 1.3.12","text":"CRAN release: 2021-09-20 Add fast K-sample BD test procedure category variables, especially GWAS datasets.","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-1311","dir":"Changelog","previous_headings":"","what":"Ball 1.3.11","title":"Ball 1.3.11","text":"CRAN release: 2021-03-17 Update citation information reference.","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-1310","dir":"Changelog","previous_headings":"","what":"Ball 1.3.10","title":"Ball 1.3.10","text":"CRAN release: 2021-01-09 Add variance (Chi-square) weight K-sample Ball Divergence test. Refine distance computation","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-139","dir":"Changelog","previous_headings":"","what":"Ball 1.3.9","title":"Ball 1.3.9","text":"CRAN release: 2019-12-17 bcorsis can conveniently analyze category variables (e.g., GWAS datasets). Add permutation-free method Ball Divergence Ball Covariance test (constant weight now). Add variance (chi-square) weight Ball Divergence test. Fix potential bugs R version 4.0","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-138","dir":"Changelog","previous_headings":"","what":"Ball 1.3.8","title":"Ball 1.3.8","text":"CRAN release: 2019-05-31 Improve reproducibility efficiency multi-threading change default number threads number CPUs available. Improve computational efficiency KBD test.","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-137","dir":"Changelog","previous_headings":"","what":"Ball 1.3.7","title":"Ball 1.3.7","text":"CRAN release: 2018-12-14 Modify ambiguous arguments bcov.test, bd.test, bcorsis Modify document","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-136","dir":"Changelog","previous_headings":"","what":"Ball 1.3.6","title":"Ball 1.3.6","text":"CRAN release: 2018-12-03 Formula interface bd.test bcov.test Optimize package dependency","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-135","dir":"Changelog","previous_headings":"","what":"Ball 1.3.5","title":"Ball 1.3.5","text":"CRAN release: 2018-11-02 Faster implementation mutual independence test Multi-thread support test mutual independence Modify document","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-130","dir":"Changelog","previous_headings":"","what":"Ball 1.3.0","title":"Ball 1.3.0","text":"CRAN release: 2018-09-30 Add KBD statistic designed detecting distribution distinction part group distributions identical. (setting kbd.type = ‚Äúmaxsum‚Äù) OPENMP based Multi-thread support KBD Optimized OPENMP parallelism","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-120","dir":"Changelog","previous_headings":"","what":"Ball 1.2.0","title":"Ball 1.2.0","text":"CRAN release: 2018-06-17 Speed feature screening. Speed mutual independence test. Another K-sample test statistic (setting kbd.type = ‚Äúmax‚Äù) implemented. good detecting distribution distinction part group distributions identical. Add complete.info component output list bcov.test, bd.test bcorsis user need re-run user want obtain test result different statistics.","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-110","dir":"Changelog","previous_headings":"","what":"Ball 1.1.0","title":"Ball 1.1.0","text":"CRAN release: 2018-05-12 Bug fix OPENMP based Multi-thread support bd.test bcov.test Speed feature screening survival data Implement Angular metric compositional data","code":""},{"path":"https://mamba413.github.io/Ball/news/index.html","id":"ball-100","dir":"Changelog","previous_headings":"","what":"Ball 1.0.0","title":"Ball 1.0.0","text":"CRAN release: 2018-01-03 Initial CRAN version","code":""}]
